import{ElementApiMixin as h,Editor as u,secureSourceElement as g,attachToForm as f}from"@ckeditor/ckeditor5-core";import{EditorUI as m,EditorUIView as w,InlineEditableUIView as p,MenuBarView as b,BalloonToolbar as y}from"@ckeditor/ckeditor5-ui";import{CKEditorError as a,getDataFromElement as E}from"@ckeditor/ckeditor5-utils";import{enableViewPlaceholder as T}from"@ckeditor/ckeditor5-engine";/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class d extends m{view;constructor(t,i){super(t),this.view=i}get element(){return this.view.editable.element}init(){const t=this.editor,i=this.view,o=t.editing.view,n=i.editable,r=o.document.getRoot();n.name=r.rootName,i.render();const l=n.element;this.setEditableElement(n.name,l),n.bind("isFocused").to(this.focusTracker),o.attachDomRoot(l),this._initPlaceholder(),this.initMenuBar(this.view.menuBarView),this.fire("ready")}destroy(){super.destroy();const t=this.view,i=this.editor.editing.view;i.getDomRoot(t.editable.name)&&i.detachDomRoot(t.editable.name),t.destroy()}_initPlaceholder(){const t=this.editor,i=t.editing.view,o=i.document.getRoot(),n=t.config.get("placeholder");if(n){const r=typeof n=="string"?n:n[o.rootName];r&&(o.placeholder=r)}T({view:i,element:o,isDirectHost:!1,keepOnFocus:!0})}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class c extends w{editable;menuBarView;constructor(t,i,o,n){super(t),this.editable=new p(t,i,o,{label:n}),this.menuBarView=new b(t),this.menuBarView.extendTemplate({attributes:{class:["ck-reset_all","ck-rounded-corners"],dir:t.uiLanguageDirection}})}render(){super.render(),this.registerChild(this.editable),this.registerChild(this.menuBarView)}}function V(e){return typeof e=="object"&&e!==null}function B(e){if(typeof e!="object"||e==null)return!1;if(Object.getPrototypeOf(e)===null)return!0;if(Object.prototype.toString.call(e)!=="[object Object]"){const i=e[Symbol.toStringTag];return i==null||!Object.getOwnPropertyDescriptor(e,Symbol.toStringTag)?.writable?!1:e.toString()===`[object ${i}]`}let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function v(e){return V(e)&&e.nodeType===1&&!B(e)}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class P extends h(u){static get editorName(){return"BalloonEditor"}ui;constructor(t,i={}){if(!s(t)&&i.initialData!==void 0)throw new a("editor-create-initial-data",null);super(i),this.config.get("initialData")===void 0&&this.config.set("initialData",R(t)),s(t)&&(this.sourceElement=t,g(this,t));const o=this.config.get("plugins");o.push(y),this.config.set("plugins",o),this.config.define("balloonToolbar",this.config.get("toolbar")),this.model.document.createRoot();const n=new c(this.locale,this.editing.view,this.sourceElement,this.config.get("label"));this.ui=new d(this,n),f(this)}destroy(){const t=this.getData();return this.ui.destroy(),super.destroy().then(()=>{this.sourceElement&&this.updateSourceElement(t)})}static create(t,i={}){return new Promise(o=>{if(s(t)&&t.tagName==="TEXTAREA")throw new a("editor-wrong-element",null);const n=new this(t,i);o(n.initPlugins().then(()=>n.ui.init()).then(()=>n.data.init(n.config.get("initialData"))).then(()=>n.fire("ready")).then(()=>n))})}}function R(e){return s(e)?E(e):e}function s(e){return v(e)}export{P as BalloonEditor,d as BalloonEditorUI,c as BalloonEditorUIView};
