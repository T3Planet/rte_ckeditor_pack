import{Plugin as se,Command as ht}from"@ckeditor/ckeditor5-core";import{logWarning as de,version as mt,FocusTracker as he,KeystrokeHandler as me,global as gt,Collection as kt}from"@ckeditor/ckeditor5-utils";import{Typing as Ne}from"@ckeditor/ckeditor5-typing";import{View as ie,addKeyboardHandlingForGrid as pt,ButtonView as ge,FocusCycler as Ve,SearchTextView as wt,createLabeledInputText as _t,createDropdown as bt,UIModel as yt,addListToDropdown as vt,SearchInfoView as jt,ViewCollection as xt,isFocusable as Et,isViewWithFocusCycler as Vt,FormHeaderView as It,ContextualBalloon as St,Dialog as Pt,MenuBarMenuListItemButtonView as Tt,clickOutsideHandler as At}from"@ckeditor/ckeditor5-ui";import{IconPreviousArrow as Bt,IconEmoji as Lt}from"@ckeditor/ckeditor5-icons";function Ot(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ke={exports:{}},Mt=ke.exports,Fe;function Nt(){return Fe||(Fe=1,(function(t){((e,i)=>{t.exports?t.exports=i():e.fuzzysort=i()})(Mt,e=>{var i=(c,s)=>{if(!c||!s)return T;var f=Le(c);K(s)||(s=H(s));var h=f.bitflags;return(h&s._bitflags)!==h?T:ee(f,s)},r=(c,s,f)=>{if(!c)return f?.all?ct(s,f):xe;var h=Le(c),m=h.bitflags,d=h.containsSpace,u=z(f?.threshold||0),k=f?.limit||je,g=0,y=0,_=s.length;function M(J){g<k?(fe.add(J),++g):(++y,J._score>fe.peek()._score&&fe.replaceTop(J))}if(f?.key)for(var B=f.key,v=0;v<_;++v){var O=s[v],j=le(O,B);if(j&&(K(j)||(j=H(j)),(m&j._bitflags)===m)){var E=ee(h,j);E!==T&&(E._score<u||(E.obj=O,M(E)))}}else if(f?.keys){var W=f.keys,D=W.length;e:for(var v=0;v<_;++v){var O=s[v];{for(var L=0,b=0;b<D;++b){var B=W[b],j=le(O,B);if(!j){ve[b]=ne;continue}K(j)||(j=H(j)),ve[b]=j,L|=j._bitflags}if((m&L)!==m)continue}if(d)for(let x=0;x<h.spaceSearches.length;x++)R[x]=N;for(var b=0;b<D;++b){if(j=ve[b],j===ne){te[b]=ne;continue}if(te[b]=ee(h,j,!1,d),te[b]===T){te[b]=ne;continue}if(d)for(let V=0;V<h.spaceSearches.length;V++){if(G[V]>-1e3&&R[V]>N){var A=(R[V]+G[V])/4;A>R[V]&&(R[V]=A)}G[V]>R[V]&&(R[V]=G[V])}}if(d){for(let x=0;x<h.spaceSearches.length;x++)if(R[x]===N)continue e}else{var w=!1;for(let x=0;x<D;x++)if(te[x]._score!==N){w=!0;break}if(!w)continue}var F=new p(D);for(let x=0;x<D;x++)F[x]=te[x];if(d){var S=0;for(let x=0;x<h.spaceSearches.length;x++)S+=R[x]}else{var S=N;for(let V=0;V<D;V++){var E=F[V];if(E._score>-1e3&&S>N){var A=(S+E._score)/4;A>S&&(S=A)}E._score>S&&(S=E._score)}}if(F.obj=O,F._score=S,f?.scoreFn){if(S=f.scoreFn(F),!S)continue;S=z(S),F._score=S}S<u||M(F)}}else for(var v=0;v<_;++v){var j=s[v];if(j&&(K(j)||(j=H(j)),(m&j._bitflags)===m)){var E=ee(h,j);E!==T&&(E._score<u||M(E))}}if(g===0)return xe;for(var q=new Array(g),v=g-1;v>=0;--v)q[v]=fe.poll();return q.total=g+y,q},n=(c,s="<b>",f="</b>")=>{for(var h=typeof s=="function"?s:void 0,m=c.target,d=m.length,u=c.indexes,k="",g=0,y=0,_=!1,M=[],B=0;B<d;++B){var v=m[B];if(u[y]===B){if(++y,_||(_=!0,h?(M.push(k),k=""):k+=s),y===u.length){h?(k+=v,M.push(h(k,g++)),k="",M.push(m.substr(B+1))):k+=v+f+m.substr(B+1);break}}else _&&(_=!1,h?(M.push(h(k,g++)),k=""):k+=f);k+=v}return h?M:k},l=c=>{typeof c=="number"?c=""+c:typeof c!="string"&&(c="");var s=_e(c);return I(c,{_targetLower:s._lower,_targetLowerCodes:s.lowerCodes,_bitflags:s.bitflags})},o=()=>{be.clear(),ye.clear()};class a{get indexes(){return this._indexes.slice(0,this._indexes.len).sort((s,f)=>s-f)}set indexes(s){return this._indexes=s}highlight(s,f){return n(this,s,f)}get score(){return P(this._score)}set score(s){this._score=z(s)}}class p extends Array{get score(){return P(this._score)}set score(s){this._score=z(s)}}var I=(c,s)=>{const f=new a;return f.target=c,f.obj=s.obj??T,f._score=s._score??N,f._indexes=s._indexes??[],f._targetLower=s._targetLower??"",f._targetLowerCodes=s._targetLowerCodes??T,f._nextBeginningIndexes=s._nextBeginningIndexes??T,f._bitflags=s._bitflags??0,f},P=c=>c===N?0:c>1?c:Math.E**(((-c+1)**.04307-1)*-2),z=c=>c===0?N:c>1?c:1-Math.pow(Math.log(c)/-2+1,1/.04307),oe=c=>{typeof c=="number"?c=""+c:typeof c!="string"&&(c=""),c=c.trim();var s=_e(c),f=[];if(s.containsSpace){var h=c.split(/\s+/);h=[...new Set(h)];for(var m=0;m<h.length;m++)if(h[m]!==""){var d=_e(h[m]);f.push({lowerCodes:d.lowerCodes,_lower:h[m].toLowerCase(),containsSpace:!1})}}return{lowerCodes:s.lowerCodes,_lower:s._lower,containsSpace:s.containsSpace,bitflags:s.bitflags,spaceSearches:f}},H=c=>{if(c.length>999)return l(c);var s=be.get(c);return s!==void 0||(s=l(c),be.set(c,s)),s},Le=c=>{if(c.length>999)return oe(c);var s=ye.get(c);return s!==void 0||(s=oe(c),ye.set(c,s)),s},ct=(c,s)=>{var f=[];f.total=c.length;var h=s?.limit||je;if(s?.key)for(var m=0;m<c.length;m++){var d=c[m],u=le(d,s.key);if(u!=T){K(u)||(u=H(u));var k=I(u.target,{_score:u._score,obj:d});if(f.push(k),f.length>=h)return f}}else if(s?.keys)for(var m=0;m<c.length;m++){for(var d=c[m],g=new p(s.keys.length),y=s.keys.length-1;y>=0;--y){var u=le(d,s.keys[y]);if(!u){g[y]=ne;continue}K(u)||(u=H(u)),u._score=N,u._indexes.len=0,g[y]=u}if(g.obj=d,g._score=N,f.push(g),f.length>=h)return f}else for(var m=0;m<c.length;m++){var u=c[m];if(u!=T&&(K(u)||(u=H(u)),u._score=N,u._indexes.len=0,f.push(u),f.length>=h))return f}return f},ee=(c,s,f=!1,h=!1)=>{if(f===!1&&c.containsSpace)return at(c,s,h);for(var m=c._lower,d=c.lowerCodes,u=d[0],k=s._targetLowerCodes,g=d.length,y=k.length,v=0,_=0,M=0;;){var B=u===k[_];if(B){if(C[M++]=_,++v,v===g)break;u=d[v]}if(++_,_>=y)return T}var v=0,O=!1,j=0,E=s._nextBeginningIndexes;E===T&&(E=s._nextBeginningIndexes=ft(s.target)),_=C[0]===0?0:E[C[0]-1];var W=0;if(_!==y)for(;;)if(_>=y){if(v<=0||(++W,W>200))break;--v;var D=ce[--j];_=E[D]}else{var B=d[v]===k[_];if(B){if(ce[j++]=_,++v,v===g){O=!0;break}++_}else _=E[_]}var L=g<=1?-1:s._targetLower.indexOf(m,C[0]),b=!!~L,A=b?L===0||s._nextBeginningIndexes[L-1]===L:!1;if(b&&!A){for(var w=0;w<E.length;w=E[w])if(!(w<=L)){for(var F=0;F<g&&d[F]===s._targetLowerCodes[w+F];F++);if(F===g){L=w,A=!0;break}}}var S=x=>{for(var V=0,Me=0,U=1;U<g;++U)x[U]-x[U-1]!==1&&(V-=x[U],++Me);var dt=x[g-1]-x[0]-(g-1);if(V-=(12+dt)*Me,x[0]!==0&&(V-=x[0]*x[0]*.2),!O)V*=1e3;else{for(var Ee=1,U=E[0];U<y;U=E[U])++Ee;Ee>24&&(V*=(Ee-24)*10)}return V-=(y-g)/2,b&&(V/=1+g*g*1),A&&(V/=1+g*g*1),V-=(y-g)/2,V};if(O)if(A){for(var w=0;w<g;++w)C[w]=L+w;var q=C,J=S(C)}else var q=ce,J=S(ce);else{if(b)for(var w=0;w<g;++w)C[w]=L+w;var q=C,J=S(q)}s._score=J;for(var w=0;w<g;++w)s._indexes[w]=q[w];s._indexes.len=g;const ue=new a;return ue.target=s.target,ue._score=s._score,ue._indexes=s._indexes,ue},at=(c,s,f)=>{for(var h=new Set,m=0,d=T,u=0,k=c.spaceSearches,g=k.length,y=0,_=()=>{for(let A=y-1;A>=0;A--)s._nextBeginningIndexes[ae[A*2+0]]=ae[A*2+1]},M=!1,b=0;b<g;++b){G[b]=N;var B=k[b];if(d=ee(B,s),f){if(d===T)continue;M=!0}else if(d===T)return _(),T;var v=b===g-1;if(!v){var O=d._indexes,j=!0;for(let w=0;w<O.len-1;w++)if(O[w+1]-O[w]!==1){j=!1;break}if(j){var E=O[O.len-1]+1,W=s._nextBeginningIndexes[E-1];for(let w=E-1;w>=0&&W===s._nextBeginningIndexes[w];w--)s._nextBeginningIndexes[w]=E,ae[y*2+0]=w,ae[y*2+1]=W,y++}}m+=d._score/g,G[b]=d._score/g,d._indexes[0]<u&&(m-=(u-d._indexes[0])*2),u=d._indexes[0];for(var D=0;D<d._indexes.len;++D)h.add(d._indexes[D])}if(f&&!M)return T;_();var L=ee(c,s,!0);if(L!==T&&L._score>m){if(f)for(var b=0;b<g;++b)G[b]=L._score/g;return L}f&&(d=s),d._score=m;var b=0;for(let A of h)d._indexes[b++]=A;return d._indexes.len=b,d},Oe=c=>c.replace(/\p{Script=Latin}+/gu,s=>s.normalize("NFD")).replace(/[\u0300-\u036f]/g,""),_e=c=>{c=Oe(c);for(var s=c.length,f=c.toLowerCase(),h=[],m=0,d=!1,u=0;u<s;++u){var k=h[u]=f.charCodeAt(u);if(k===32){d=!0;continue}var g=k>=97&&k<=122?k-97:k>=48&&k<=57?26:k<=127?30:31;m|=1<<g}return{lowerCodes:h,bitflags:m,containsSpace:d,_lower:f}},lt=c=>{for(var s=c.length,f=[],h=0,m=!1,d=!1,u=0;u<s;++u){var k=c.charCodeAt(u),g=k>=65&&k<=90,y=g||k>=97&&k<=122||k>=48&&k<=57,_=g&&!m||!d||!y;m=g,d=y,_&&(f[h++]=u)}return f},ft=c=>{c=Oe(c);for(var s=c.length,f=lt(c),h=[],m=f[0],d=0,u=0;u<s;++u)m>u?h[u]=m:(m=f[++d],h[u]=m===void 0?s:m);return h},be=new Map,ye=new Map,C=[],ce=[],ae=[],R=[],G=[],ve=[],te=[],le=(c,s)=>{var f=c[s];if(f!==void 0)return f;if(typeof s=="function")return s(c);var h=s;Array.isArray(s)||(h=s.split("."));for(var m=h.length,d=-1;c&&++d<m;)c=c[h[d]];return c},K=c=>typeof c=="object"&&typeof c._bitflags=="number",je=1/0,N=-je,xe=[];xe.total=0;var T=null,ne=l(""),ut=c=>{var s=[],f=0,h={},m=d=>{for(var u=0,k=s[u],g=1;g<f;){var y=g+1;u=g,y<f&&s[y]._score<s[g]._score&&(u=y),s[u-1>>1]=s[u],g=1+(u<<1)}for(var _=u-1>>1;u>0&&k._score<s[_]._score;_=(u=_)-1>>1)s[u]=s[_];s[u]=k};return h.add=(d=>{var u=f;s[f++]=d;for(var k=u-1>>1;u>0&&d._score<s[k]._score;k=(u=k)-1>>1)s[u]=s[k];s[u]=d}),h.poll=(d=>{if(f!==0){var u=s[0];return s[0]=s[--f],m(),u}}),h.peek=(d=>{if(f!==0)return s[0]}),h.replaceTop=(d=>{s[0]=d,m()}),h},fe=ut();return{single:i,go:r,prepare:l,cleanup:o}})})(ke)),ke.exports}var Ft=Nt(),Dt=Ot(Ft);function Ct(t){return Number.isSafeInteger(t)&&t>=0}function Rt(t){return t!=null&&typeof t!="function"&&Ct(t.length)}function De(t){return t}function Ie(t){return t==="__proto__"}function Ce(t){switch(typeof t){case"number":case"symbol":return!1;case"string":return t.includes(".")||t.includes("[")||t.includes("]")}}function Re(t){return typeof t=="string"||typeof t=="symbol"?t:Object.is(t?.valueOf?.(),-0)?"-0":String(t)}function Ue(t){const e=[],i=t.length;if(i===0)return e;let r=0,n="",l="",o=!1;for(t.charCodeAt(0)===46&&(e.push(""),r++);r<i;){const a=t[r];l?a==="\\"&&r+1<i?(r++,n+=t[r]):a===l?l="":n+=a:o?a==='"'||a==="'"?l=a:a==="]"?(o=!1,e.push(n),n=""):n+=a:a==="["?(o=!0,n&&(e.push(n),n="")):a==="."?n&&(e.push(n),n=""):n+=a,r++}return n&&e.push(n),e}function Se(t,e,i){if(t==null)return i;switch(typeof e){case"string":{if(Ie(e))return i;const r=t[e];return r===void 0?Ce(e)?Se(t,Ue(e),i):i:r}case"number":case"symbol":{typeof e=="number"&&(e=Re(e));const r=t[e];return r===void 0?i:r}default:{if(Array.isArray(e))return Ut(t,e,i);if(Object.is(e?.valueOf(),-0)?e="-0":e=String(e),Ie(e))return i;const r=t[e];return r===void 0?i:r}}}function Ut(t,e,i){if(e.length===0)return i;let r=t;for(let n=0;n<e.length;n++){if(r==null||Ie(e[n]))return i;r=r[e[n]]}return r===void 0?i:r}function zt(t){return function(e){return Se(e,t)}}function Wt(t){return t!==null&&(typeof t=="object"||typeof t=="function")}function ze(t){return t==null||typeof t!="object"&&typeof t!="function"}function We(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function qt(t,e,i){return typeof i!="function"?Te(t,e):Pe(t,e,function r(n,l,o,a,p,I){const P=i(n,l,o,a,p,I);return P!==void 0?!!P:Pe(n,l,r,I)},new Map)}function Pe(t,e,i,r){if(e===t)return!0;switch(typeof e){case"object":return $t(t,e,i,r);case"function":return Object.keys(e).length>0?Pe(t,{...e},i,r):We(t,e);default:return Wt(t)?typeof e=="string"?e==="":!0:We(t,e)}}function $t(t,e,i,r){if(e==null)return!0;if(Array.isArray(e))return qe(t,e,i,r);if(e instanceof Map)return Ht(t,e,i,r);if(e instanceof Set)return Gt(t,e,i,r);const n=Object.keys(e);if(t==null)return n.length===0;if(n.length===0)return!0;if(r&&r.has(e))return r.get(e)===t;r&&r.set(e,t);try{for(let l=0;l<n.length;l++){const o=n[l];if(!ze(t)&&!(o in t)||e[o]===void 0&&t[o]!==void 0||e[o]===null&&t[o]!==null||!i(t[o],e[o],o,t,e,r))return!1}return!0}finally{r&&r.delete(e)}}function Ht(t,e,i,r){if(e.size===0)return!0;if(!(t instanceof Map))return!1;for(const[n,l]of e.entries()){const o=t.get(n);if(i(o,l,n,t,e,r)===!1)return!1}return!0}function qe(t,e,i,r){if(e.length===0)return!0;if(!Array.isArray(t))return!1;const n=new Set;for(let l=0;l<e.length;l++){const o=e[l];let a=!1;for(let p=0;p<t.length;p++){if(n.has(p))continue;const I=t[p];let P=!1;if(i(I,o,l,t,e,r)&&(P=!0),P){n.add(p),a=!0;break}}if(!a)return!1}return!0}function Gt(t,e,i,r){return e.size===0?!0:t instanceof Set?qe([...t],[...e],i,r):!1}function Te(t,e){return qt(t,e,()=>{})}function Kt(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function $e(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const Jt="[object RegExp]",He="[object String]",Ge="[object Number]",Ke="[object Boolean]",Je="[object Arguments]",Qt="[object Symbol]",Zt="[object Date]",Yt="[object Map]",Xt="[object Set]",ei="[object Array]",ti="[object ArrayBuffer]",ii="[object Object]",ri="[object DataView]",ni="[object Uint8Array]",si="[object Uint8ClampedArray]",oi="[object Uint16Array]",ci="[object Uint32Array]",ai="[object Int8Array]",li="[object Int16Array]",fi="[object Int32Array]",ui="[object Float32Array]",di="[object Float64Array]";function hi(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function mi(t,e){return Q(t,void 0,t,new Map,e)}function Q(t,e,i,r=new Map,n=void 0){const l=n?.(t,e,i,r);if(l!=null)return l;if(ze(t))return t;if(r.has(t))return r.get(t);if(Array.isArray(t)){const o=new Array(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=Q(t[a],a,i,r,n);return Object.hasOwn(t,"index")&&(o.index=t.index),Object.hasOwn(t,"input")&&(o.input=t.input),o}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const o=new RegExp(t.source,t.flags);return o.lastIndex=t.lastIndex,o}if(t instanceof Map){const o=new Map;r.set(t,o);for(const[a,p]of t)o.set(a,Q(p,a,i,r,n));return o}if(t instanceof Set){const o=new Set;r.set(t,o);for(const a of t)o.add(Q(a,void 0,i,r,n));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(t))return t.subarray();if(hi(t)){const o=new(Object.getPrototypeOf(t)).constructor(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=Q(t[a],a,i,r,n);return o}if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);if(t instanceof DataView){const o=new DataView(t.buffer.slice(0),t.byteOffset,t.byteLength);return r.set(t,o),Z(o,t,i,r,n),o}if(typeof File<"u"&&t instanceof File){const o=new File([t],t.name,{type:t.type});return r.set(t,o),Z(o,t,i,r,n),o}if(t instanceof Blob){const o=new Blob([t],{type:t.type});return r.set(t,o),Z(o,t,i,r,n),o}if(t instanceof Error){const o=new t.constructor;return r.set(t,o),o.message=t.message,o.name=t.name,o.stack=t.stack,o.cause=t.cause,Z(o,t,i,r,n),o}if(typeof t=="object"&&gi(t)){const o=Object.create(Object.getPrototypeOf(t));return r.set(t,o),Z(o,t,i,r,n),o}return t}function Z(t,e,i=t,r,n){const l=[...Object.keys(e),...Kt(e)];for(let o=0;o<l.length;o++){const a=l[o],p=Object.getOwnPropertyDescriptor(t,a);(p==null||p.writable)&&(t[a]=Q(e[a],a,i,r,n))}}function gi(t){switch($e(t)){case Je:case ei:case ti:case ri:case Ke:case Zt:case ui:case di:case ai:case li:case fi:case Yt:case Ge:case ii:case Jt:case Xt:case He:case Qt:case ni:case si:case oi:case ci:return!0;default:return!1}}function ki(t){return Q(t,void 0,t,new Map,void 0)}function pi(t){return t=ki(t),e=>Te(e,t)}function wi(t,e){return mi(t,(i,r,n,l)=>{if(typeof t=="object")switch(Object.prototype.toString.call(t)){case Ge:case He:case Ke:{const o=new t.constructor(t?.valueOf());return Z(o,t),o}case Je:{const o={};return Z(o,t),o.length=t.length,o[Symbol.iterator]=t[Symbol.iterator],o}default:return}})}function _i(t){return wi(t)}const bi=/^(?:0|[1-9]\d*)$/;function yi(t,e=Number.MAX_SAFE_INTEGER){switch(typeof t){case"number":return Number.isInteger(t)&&t>=0&&t<e;case"symbol":return!1;case"string":return bi.test(t)}}function vi(t){return t!==null&&typeof t=="object"&&$e(t)==="[object Arguments]"}function ji(t,e){let i;if(Array.isArray(e)?i=e:typeof e=="string"&&Ce(e)&&t?.[e]==null?i=Ue(e):i=[e],i.length===0)return!1;let r=t;for(let n=0;n<i.length;n++){const l=i[n];if((r==null||!Object.hasOwn(r,l))&&!((Array.isArray(r)||vi(r))&&yi(l)&&l<r.length))return!1;r=r[l]}return!0}function xi(t,e){switch(typeof t){case"object":{Object.is(t?.valueOf(),-0)&&(t="-0");break}case"number":{t=Re(t);break}}return e=_i(e),function(i){const r=Se(i,t);return r===void 0?ji(i,t):e===void 0?r===void 0:Te(r,e)}}function Ei(t){if(t==null)return De;switch(typeof t){case"function":return t;case"object":return Array.isArray(t)&&t.length===2?xi(t[0],t[1]):pi(t);case"string":case"symbol":case"number":return zt(t)}}function Vi(t,e){const i={};for(let r=0;r<t.length;r++){const n=t[r],l=e(n);Object.hasOwn(i,l)||(i[l]=[]),i[l].push(n)}return i}function Ii(t,e){if(t==null)return{};const i=Rt(t)?Array.from(t):Object.values(t),r=Ei(e??De);return Vi(i,r)}function Qe(t){if(t==null)return"";if(typeof t=="string")return t;if(Array.isArray(t))return t.map(Qe).join(",");const e=String(t);return e==="0"&&Object.is(Number(t),-0)?"-0":e}function Si(t){return t.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&")}function Pi(t){return Si(Qe(t))}/**
* @license Copyright (c) 2023, Koala Interactive SAS
* For licensing, see https://github.com/koala-interactive/is-emoji-supported/blob/master/LICENSE.md
*/function Ze(t){const e=Ti();/* istanbul ignore next -- @preserve */if(!e)return!1;const i=25,r=20,n=Math.floor(i/2);e.font=n+"px Arial, Sans-Serif",e.textBaseline="top",e.canvas.width=r*2,e.canvas.height=i,e.clearRect(0,0,r*2,i),e.fillStyle="#FF0000",e.fillText(t,0,22),e.fillStyle="#0000FF",e.fillText(t,r,22);const l=e.getImageData(0,0,r,i).data,o=l.length;let a=0;for(;a<o&&!l[a+3];a+=4);/* istanbul ignore next -- @preserve */if(a>=o)return!1;const p=r+a/4%r,I=Math.floor(a/4/r),P=e.getImageData(p,I,1,1).data;/* istanbul ignore next -- @preserve */if(l[a]!==P[0]||l[a+2]!==P[2])return!1;/* istanbul ignore next -- @preserve */return!(e.measureText(t).width>=r)}function Ti(){try{return document.createElement("canvas").getContext("2d",{willReadFrequently:!0})}catch{/* istanbul ignore next -- @preserve */return null}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/const Ai={0:"default",1:"light",2:"medium-light",3:"medium",4:"medium-dark",5:"dark"},Bi={"\u{1FAE9}":16,"\u{1FAE8}":15.1,"\u{1FAE0}":14,"\u{1F636}\u200D\u{1F32B}\uFE0F":13.1,"\u{1F9D1}\u200D\u{1F4BB}":12.1,"\u{1F970}":11,"\u{1F92A}":5,"\u2695\uFE0F":4,"\u{1F923}":3,"\u{1F44B}\u{1F3FD}":2,"\u{1F600}":1,"\u{1F610}":.7,"\u{1F602}":.6},pe=24;class we extends se{_emojiCanvas=null;static get pluginName(){return"EmojiUtils"}static get isOfficialPlugin(){return!0}init(){this._emojiCanvas=document.createElement("canvas").getContext("2d")}isEmojiSupported(e,i,r){return e.version<=i?this.hasZwj(e.emoji)?this.isEmojiZwjSupported(e,r):!0:!1}getEmojiSupportedVersionByOs(){for(const[e,i]of Object.entries(Bi))if(we._isEmojiSupported(e))return i;return 0}hasZwj(e){return e.includes("\u200D")}isEmojiZwjSupported(e,i){return this.getNodeWidthUsingCanvas(i,e.emoji)<pe*1.8?!0:this.getNodeWidth(i,e.emoji)<pe*1.8}getNodeWidth(e,i){const r=document.createElement("span");r.textContent=i,e.appendChild(r);const n=r.offsetWidth;return e.removeChild(r),n}getNodeWidthUsingCanvas(e,i){const r=getComputedStyle(e);return this._emojiCanvas.font=[r.fontStyle,r.fontVariant,r.fontWeight,`${pe}px`,`"Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", ${r.fontFamily}`].join(" "),Math.ceil(this._emojiCanvas.measureText(i).width)}createEmojiWidthTestingContainer(){const e=document.createElement("div");return e.setAttribute("aria-hidden","true"),e.style.position="absolute",e.style.left="-9999px",e.style.whiteSpace="nowrap",e.style.fontSize=pe+"px",e}normalizeEmojiSkinTone(e){const i={...e,skins:{default:e.emoji}};return e.skins&&e.skins.forEach(r=>{const n=Ai[r.tone];i.skins[n]=r.emoji}),i}isEmojiCategoryAllowed(e){return e.group!==2}static _isEmojiSupported=Ze}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/const Li="https://cdn.ckeditor.com/ckeditor5/data/emoji/{version}/en.json",Oi=16;class X extends se{_items;_url;_repositoryPromise;static get requires(){return[we]}static get pluginName(){return"EmojiRepository"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define("emoji",{version:void 0,skinTone:"default",definitionsUrl:void 0,useCustomFont:!1}),this._url=this._getUrl(),this._repositoryPromise=new Promise(i=>{this._repositoryPromiseResolveCallback=i}),this._items=null}async init(){return this._warnAboutCdnUse(),await this._loadAndCacheEmoji(),this._items=this._getItems(),this._items?this._repositoryPromiseResolveCallback(!0):(de("emoji-repository-empty"),this._repositoryPromiseResolveCallback(!1))}getEmojiByQuery(e){return this._items?e.split(/\s/).filter(Boolean).some(n=>n.length>=2)?Dt.go(e,this._items,{threshold:.6,keys:["emoticon","annotation",n=>e.split(/\s/).filter(Boolean).flatMap(a=>n.tags?.filter(p=>p.startsWith(a))).join()]}).map(n=>n.obj):[]:[]}getEmojiCategories(){const e=this._getItems();if(!e)return[];const{t:i}=this.editor.locale,r=[{title:i("Smileys & Expressions"),icon:"\u{1F604}",groupId:0},{title:i("Gestures & People"),icon:"\u{1F44B}",groupId:1},{title:i("Animals & Nature"),icon:"\u{1F43B}",groupId:3},{title:i("Food & Drinks"),icon:"\u{1F34E}",groupId:4},{title:i("Travel & Places"),icon:"\u{1F698}",groupId:5},{title:i("Activities"),icon:"\u{1F3C0}",groupId:6},{title:i("Objects"),icon:"\u{1F4A1}",groupId:7},{title:i("Symbols"),icon:"\u{1F535}",groupId:8},{title:i("Flags"),icon:"\u{1F3C1}",groupId:9}],n=Ii(e,l=>l.group);return r.map(l=>({...l,items:n[l.groupId]}))}getSkinTones(){const{t:e}=this.editor.locale;return[{id:"default",icon:"\u{1F44B}",tooltip:e("Default skin tone")},{id:"light",icon:"\u{1F44B}\u{1F3FB}",tooltip:e("Light skin tone")},{id:"medium-light",icon:"\u{1F44B}\u{1F3FC}",tooltip:e("Medium Light skin tone")},{id:"medium",icon:"\u{1F44B}\u{1F3FD}",tooltip:e("Medium skin tone")},{id:"medium-dark",icon:"\u{1F44B}\u{1F3FE}",tooltip:e("Medium Dark skin tone")},{id:"dark",icon:"\u{1F44B}\u{1F3FF}",tooltip:e("Dark skin tone")}]}isReady(){return this._repositoryPromise}_getUrl(){const{definitionsUrl:e,version:i}=this.editor.config.get("emoji");if(!e||e==="cdn"){const r=i||Oi,n=new URL(Li.replace("{version}",r.toString()));return n.searchParams.set("editorVersion",mt),n}return i&&de("emoji-repository-redundant-version"),new URL(e)}_warnAboutCdnUse(){const e=this.editor,i=e.config.get("emoji"),r=e.config.get("licenseKey"),n=window[Symbol.for("cke distribution")];r!=="GPL"&&n!=="cloud"&&(i&&i.definitionsUrl||de("emoji-repository-cdn-use"))}_getItems(){const e=X._results[this._url.href];return e&&e.length?e:null}async _loadAndCacheEmoji(){if(X._results[this._url.href])return;const e=await fetch(this._url,{cache:"force-cache"}).then(i=>i.ok?i.json():[]).catch(()=>[]);X._results[this._url.href]=this._normalizeEmoji(e)}_normalizeEmoji(e){const i=this.editor,r=i.config.get("emoji.useCustomFont"),n=i.plugins.get("EmojiUtils"),l=e.filter(I=>n.isEmojiCategoryAllowed(I));if(r)return l.map(I=>n.normalizeEmojiSkinTone(I));const o=n.getEmojiSupportedVersionByOs(),a=n.createEmojiWidthTestingContainer();document.body.appendChild(a);const p=l.filter(I=>n.isEmojiSupported(I,o,a)).map(I=>n.normalizeEmojiSkinTone(I));return a.remove(),p}static _results={}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/const re=":",Ae=":__EMOJI_SHOW_ALL:",Be=":__EMOJI_HINT:";class Ye extends se{_emojiDropdownLimit;_skinTone;static get requires(){return[X,Ne,"Mention"]}static get pluginName(){return"EmojiMention"}static get isOfficialPlugin(){return!0}constructor(e){super(e),this.editor.config.define("emoji",{dropdownLimit:6}),this._emojiDropdownLimit=e.config.get("emoji.dropdownLimit"),this._skinTone=e.config.get("emoji.skinTone"),this._setupMentionConfiguration(e)}_setupMentionConfiguration(e){const i=e.config.get("mergeFields.prefix"),r=e.config.get("mention.feeds"),n=i?i[0]===re:!1;if(r.filter(p=>!p._isEmojiMarker).some(p=>p.marker===re)||n){de("emoji-config-marker-already-used",{marker:re});return}if(r.some(p=>p._isEmojiMarker))return;const a={_isEmojiMarker:!0,marker:re,dropdownLimit:this._emojiDropdownLimit,itemRenderer:this._customItemRendererFactory(this.editor.t),feed:this._queryEmojiCallbackFactory()};this.editor.config.set("mention.feeds",[...r,a])}async init(){const e=this.editor;this.emojiPickerPlugin=e.plugins.has("EmojiPicker")?e.plugins.get("EmojiPicker"):null,this.emojiRepositoryPlugin=e.plugins.get("EmojiRepository"),this._isEmojiRepositoryAvailable=await this.emojiRepositoryPlugin.isReady(),this._isEmojiRepositoryAvailable&&e.once("ready",this._overrideMentionExecuteListener.bind(this))}_customItemRendererFactory(e){return i=>{const r=document.createElement("button");r.classList.add("ck"),r.classList.add("ck-button"),r.classList.add("ck-button_with-text"),r.id=`mention-list-item-id${i.id.slice(0,-1)}`,r.type="button",r.tabIndex=-1;const n=document.createElement("span");return n.classList.add("ck"),n.classList.add("ck-button__label"),r.appendChild(n),i.id===Be?(r.classList.add("ck-list-item-button"),r.classList.add("ck-disabled"),n.textContent=e("Keep on typing to see the emoji.")):i.id===Ae?n.textContent=e("Show all emoji..."):n.textContent=`${i.text} ${i.id}`,r}}_overrideMentionExecuteListener(){const e=this.editor;e.commands.get("mention").on("execute",(i,r)=>{const n=r[0];if(n.marker===re&&(i.stop(),n.mention.id!==Be))if(n.mention.id===Ae){const l=[...n.range.getItems()].filter(a=>a.is("$textProxy")).map(a=>a.data).reduce((a,p)=>a+p,"");e.model.change(a=>{e.model.deleteContent(a.createSelection(n.range))});const o=this.emojiPickerPlugin;o.showUI(l.slice(1)),setTimeout(()=>{o.emojiPickerView.focus()})}else e.execute("insertText",{text:n.mention.text,range:n.range})},{priority:"high"})}_queryEmojiCallbackFactory(){return e=>{if(e.startsWith(" "))return[];if(e.startsWith(re))return[];if(!this._isEmojiRepositoryAvailable)return[];const i=this.emojiRepositoryPlugin.getEmojiByQuery(e).map(n=>{let l=n.skins[this._skinTone]||n.skins.default;return this.emojiPickerPlugin&&(l=n.skins[this.emojiPickerPlugin.skinTone]||n.skins.default),{id:`:${n.annotation}:`,text:l}});if(!this.emojiPickerPlugin)return i.slice(0,this._emojiDropdownLimit);const r={id:e.length>1?Ae:Be};return[...i.slice(0,this._emojiDropdownLimit-1),r]}}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class Xe extends ht{refresh(){const i=this.editor.model,r=i.schema,n=i.document.selection;this.isEnabled=r.checkChild(n.getFirstPosition(),"$text")}execute(e=""){this.editor.plugins.get("EmojiPicker").showUI(e)}}function Y(t,{insertAt:e}={}){if(!t||typeof document>"u")return;const i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",window.litNonce&&r.setAttribute("nonce",window.litNonce),e==="top"&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}Y(":root{--ck-emoji-grid-tile-size:27px}.ck.ck-emoji .ck.ck-emoji__tiles{border-top:1px solid var(--ck-color-base-border);max-height:min(265px,40vh);max-width:100%;overflow-x:hidden;overflow-y:auto}.ck.ck-emoji .ck.ck-emoji__tiles .ck-emoji__grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(var(--ck-emoji-grid-tile-size),1fr));margin:var(--ck-spacing-standard) var(--ck-spacing-large);grid-gap:var(--ck-spacing-small)}.ck.ck-emoji .ck.ck-emoji__tiles .ck-emoji__tile{border:0;font-size:1.5em;height:var(--ck-emoji-grid-tile-size);min-height:var(--ck-emoji-grid-tile-size);min-width:var(--ck-emoji-grid-tile-size);padding:0;transition:box-shadow .2s ease;width:var(--ck-emoji-grid-tile-size)}@media (prefers-reduced-motion:reduce){.ck.ck-emoji .ck.ck-emoji__tiles .ck-emoji__tile{transition:none}}.ck.ck-emoji .ck.ck-emoji__tiles .ck-emoji__tile:focus:not(.ck-disabled),.ck.ck-emoji .ck.ck-emoji__tiles .ck-emoji__tile:hover:not(.ck-disabled){border:0;box-shadow:inset 0 0 0 1px var(--ck-color-base-background),0 0 0 2px var(--ck-color-focus-border)}.ck.ck-emoji .ck.ck-emoji__tiles .ck-emoji__tile .ck-button__label{line-height:var(--ck-emoji-grid-tile-size);text-align:center;width:100%}");/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class et extends ie{tiles;focusTracker;keystrokes;emojiCategories;cachedTiles;_getEmojiByQuery;constructor(e,{categoryName:i,emojiCategories:r,getEmojiByQuery:n,skinTone:l}){super(e),this.set("isEmpty",!0),this.set("categoryName",i),this.set("skinTone",l),this.tiles=this.createCollection(),this.cachedTiles=this.createCollection(),this.focusTracker=new he,this.keystrokes=new me,this._getEmojiByQuery=n,this.emojiCategories=r;const o=this.bindTemplate;this.setTemplate({tag:"div",children:[{tag:"div",attributes:{role:"grid",class:["ck","ck-emoji__grid"]},children:this.tiles}],attributes:{role:"tabpanel",class:["ck","ck-emoji__tiles",o.if("isEmpty","ck-hidden",a=>a)]}}),pt({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.tiles,numberOfColumns:()=>gt.window.getComputedStyle(this.element.firstChild).getPropertyValue("grid-template-columns").split(" ").length,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection})}render(){super.render(),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.keystrokes.destroy(),this.focusTracker.destroy()}focus(){const e=this.tiles.first;e&&e.focus()}filter(e){const{matchingItems:i,allItems:r}=e?this._getItemsByQuery(e.source):this._getItemsByCategory();return this._updateGrid(i),this.set("isEmpty",i.length===0),{resultsCount:i.length,totalItemsCount:r.length}}_getItemsByQuery(e){return{matchingItems:this._getEmojiByQuery(e),allItems:this.emojiCategories.flatMap(i=>i.items)}}_getItemsByCategory(){const e=this.emojiCategories.find(r=>r.title===this.categoryName),{items:i}=e;return{matchingItems:i,allItems:i}}_updateGrid(e){[...this.tiles].forEach(i=>{this.focusTracker.remove(i),this.tiles.remove(i)}),e.map(i=>{const r=i.skins[this.skinTone]||i.skins.default;return this.cachedTiles.get(r)||this._createTile(r,i.annotation)}).forEach(i=>{this.tiles.add(i),this.focusTracker.add(i)})}_createTile(e,i){const r=new ge(this.locale);return r.viewUid=e,r.extendTemplate({attributes:{class:["ck-emoji__tile"]}}),r.set({label:e,tooltip:i,withText:!0,ariaLabel:i,ariaLabelledBy:void 0}),r.on("execute",()=>{this.fire("execute",{name:i,emoji:e})}),this.cachedTiles.add(r),r}}Y(".ck.ck-emoji__categories-list{display:flex;justify-content:space-between;margin:0 var(--ck-spacing-large)}.ck.ck-emoji__categories-list>.ck.ck-button.ck-button_with-text{border-width:0;border-bottom:2px solid transparent;font-size:var(--ck-font-size-big);min-height:var(--ck-font-size-big);min-width:var(--ck-font-size-big);padding:0}.ck.ck-emoji__categories-list>.ck.ck-button.ck-button_with-text.ck-emoji__category-item.ck-on{border-bottom-color:var(--ck-color-base-active)}.ck.ck-emoji__categories-list>.ck.ck-button.ck-button_with-text>span{margin:auto}");/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class tt extends ie{focusTracker;keystrokes;focusCycler;buttonViews;constructor(e,{emojiCategories:i,categoryName:r}){super(e),this.buttonViews=this.createCollection(i.map(n=>this._createCategoryButton(n))),this.focusTracker=new he,this.keystrokes=new me,this.focusCycler=new Ve({focusables:this.buttonViews,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowleft",focusNext:"arrowright"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-emoji__categories-list"],role:"tablist"},children:this.buttonViews}),this.on("change:categoryName",(n,l,o,a)=>{const p=this.buttonViews.find(P=>P.tooltip===a);p&&(p.isOn=!1);const I=this.buttonViews.find(P=>P.tooltip===o);I.isOn=!0}),this.set("categoryName",r)}render(){super.render(),this.buttonViews.forEach(e=>{this.focusTracker.add(e)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy(),this.buttonViews.destroy()}focus(){this.buttonViews.first.focus()}enableCategories(){this.buttonViews.forEach(e=>{e.isEnabled=!0})}disableCategories(){this.buttonViews.forEach(e=>{e.set({class:"",isEnabled:!1,isOn:!1})})}_createCategoryButton(e){const i=new ge,r=i.bindTemplate;return i.extendTemplate({attributes:{"aria-selected":r.to("isOn",n=>n.toString()),class:["ck-emoji__category-item"]}}),i.set({ariaLabel:e.title,label:e.icon,role:"tab",tooltip:e.title,withText:!0,ariaLabelledBy:void 0}),i.on("execute",()=>{this.categoryName=e.title}),i.on("change:isEnabled",()=>{i.isEnabled&&i.tooltip===this.categoryName&&(i.isOn=!0)}),i}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class it extends ie{inputView;gridView;constructor(e,{gridView:i,resultsView:r}){super(e),this.gridView=i;const n=e.t;this.inputView=new wt(this.locale,{queryView:{label:n("Find an emoji (min. 2 characters)"),creator:_t},filteredView:this.gridView,infoView:{instance:r}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-search"],tabindex:"-1"},children:[this.inputView.queryView]}),this.inputView.delegate("search").to(this)}destroy(){super.destroy(),this.inputView.destroy()}search(e){const i=e?new RegExp(Pi(e),"ig"):null,r=this.gridView.filter(i);this.inputView.fire("search",{query:e,...r})}setInputValue(e){e?this.inputView.queryView.fieldView.value=e:this.inputView.queryView.fieldView.reset()}getInputValue(){return this.inputView.queryView.fieldView.element.value}focus(){this.inputView.focus()}}Y(".ck.ck-emoji__skin-tone{margin-left:var(--ck-spacing-standard)}.ck.ck-emoji__skin-tone>.ck.ck-dropdown .ck.ck-list__item{min-width:1em}.ck.ck-emoji__skin-tone>.ck.ck-dropdown .ck-button.ck-dropdown__button .ck-button__label{width:auto}");/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class rt extends ie{dropdownView;_skinTones;constructor(e,{skinTone:i,skinTones:r}){super(e),this.set("skinTone",i),this._skinTones=r;const n=e.t,l=n("Select skin tone"),o=bt(e),a=new kt;for(const{id:p,icon:I,tooltip:P}of this._skinTones){const z={type:"button",model:new yt({value:p,label:I,ariaLabel:P,tooltip:P,tooltipPosition:"e",role:"menuitemradio",withText:!0,ariaLabelledBy:void 0})};z.model.bind("isOn").to(this,"skinTone",oe=>oe===p),a.add(z)}vt(o,a,{ariaLabel:l,role:"menu"}),o.buttonView.set({label:this._getSkinTone().icon,ariaLabel:l,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:l}),this.dropdownView=o,this.listenTo(o,"execute",p=>{this.skinTone=p.source.value}),o.buttonView.bind("label").to(this,"skinTone",()=>this._getSkinTone().icon),o.buttonView.bind("ariaLabel").to(this,"skinTone",()=>`${this._getSkinTone().tooltip}, ${l}`),this.setTemplate({tag:"div",attributes:{class:["ck","ck-emoji__skin-tone"]},children:[o]})}focus(){this.dropdownView.buttonView.focus()}_getSkinTone(){return this._skinTones.find(e=>e.id===this.skinTone)}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class nt extends ie{items;focusTracker;keystrokes;focusCycler;searchView;toneView;categoriesView;gridView;infoView;constructor(e,{emojiCategories:i,getEmojiByQuery:r,skinTone:n,skinTones:l}){super(e);const o=i[0].title;this.gridView=new et(e,{categoryName:o,emojiCategories:i,getEmojiByQuery:r,skinTone:n}),this.infoView=new jt,this.searchView=new it(e,{gridView:this.gridView,resultsView:this.infoView}),this.categoriesView=new tt(e,{emojiCategories:i,categoryName:o}),this.toneView=new rt(e,{skinTone:n,skinTones:l}),this.items=this.createCollection([this.searchView,this.toneView,this.categoriesView,this.gridView,this.infoView]),this.focusTracker=new he,this.keystrokes=new me,this.focusCycler=new Ve({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",children:[{tag:"div",children:[this.searchView,this.toneView],attributes:{class:["ck","ck-emoji__search"]}},this.categoriesView,this.gridView,{tag:"div",children:[this.infoView],attributes:{class:["ck","ck-search__results"]}}],attributes:{tabindex:"-1",class:["ck","ck-emoji","ck-search"]}}),this._setupEventListeners()}render(){super.render(),this.focusTracker.add(this.searchView.element),this.focusTracker.add(this.toneView.element),this.focusTracker.add(this.categoriesView.element),this.focusTracker.add(this.gridView.element),this.focusTracker.add(this.infoView.element),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.searchView.focus()}_setupEventListeners(){const e=this.locale.t;this.searchView.on("search",(i,r)=>{r.query?this.categoriesView.disableCategories():this.categoriesView.enableCategories()}),this.searchView.on("search",(i,r)=>{r.query.length===1?this.infoView.set({primaryText:e("Keep on typing to see the emoji."),secondaryText:e("The query must contain at least two characters."),isVisible:!0}):r.resultsCount?this.infoView.set({isVisible:!1}):this.infoView.set({primaryText:e('No emojis were found matching "%0".',r.query),secondaryText:e("Please try a different phrase or check the spelling."),isVisible:!0})}),this.searchView.on("search",()=>{this.fire("update"),this.gridView.element.scrollTo(0,0)}),this.categoriesView.on("change:categoryName",(i,r,n)=>{this.gridView.categoryName=n,this.searchView.search("")}),this.toneView.on("change:skinTone",(i,r,n)=>{this.gridView.skinTone=n,this.searchView.search(this.searchView.getInputValue())})}}Y('.ck-vertical-form .ck-button:after{bottom:-1px;content:"";position:absolute;right:-1px;top:-1px;width:0;z-index:1}.ck-vertical-form .ck-button:focus:after{display:none}@media screen and (max-width:600px){.ck.ck-responsive-form .ck-button:after{bottom:-1px;content:"";position:absolute;right:-1px;top:-1px;width:0;z-index:1}.ck.ck-responsive-form .ck-button:focus:after{display:none}}.ck-vertical-form>.ck-button:nth-last-child(2):after{border-right:1px solid var(--ck-color-base-border)}.ck.ck-responsive-form{padding:var(--ck-spacing-large)}.ck.ck-responsive-form:focus{outline:none}[dir=ltr] .ck.ck-responsive-form>:not(:first-child),[dir=rtl] .ck.ck-responsive-form>:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-responsive-form{padding:0;width:calc(var(--ck-input-width)*.8)}.ck.ck-responsive-form .ck-labeled-field-view{margin:var(--ck-spacing-large) var(--ck-spacing-large) 0}.ck.ck-responsive-form .ck-labeled-field-view .ck-input-number,.ck.ck-responsive-form .ck-labeled-field-view .ck-input-text{min-width:0;width:100%}.ck.ck-responsive-form .ck-labeled-field-view .ck-labeled-field-view__error{white-space:normal}.ck.ck-responsive-form>.ck-button:nth-last-child(2):after{border-right:1px solid var(--ck-color-base-border)}.ck.ck-responsive-form>.ck-button:last-child,.ck.ck-responsive-form>.ck-button:nth-last-child(2){border-radius:0;margin-top:var(--ck-spacing-large);padding:var(--ck-spacing-standard)}.ck.ck-responsive-form>.ck-button:last-child:not(:focus),.ck.ck-responsive-form>.ck-button:nth-last-child(2):not(:focus){border-top:1px solid var(--ck-color-base-border)}[dir=ltr] .ck.ck-responsive-form>.ck-button:last-child,[dir=ltr] .ck.ck-responsive-form>.ck-button:nth-last-child(2),[dir=rtl] .ck.ck-responsive-form>.ck-button:last-child,[dir=rtl] .ck.ck-responsive-form>.ck-button:nth-last-child(2){margin-left:0}[dir=rtl] .ck.ck-responsive-form>.ck-button:last-child:last-of-type,[dir=rtl] .ck.ck-responsive-form>.ck-button:nth-last-child(2):last-of-type{border-right:1px solid var(--ck-color-base-border)}}'),Y(":root{--ck-form-default-width:340px}.ck.ck-form{padding:0 0 var(--ck-spacing-large)}.ck.ck-form.ck-form_default-width{width:var(--ck-form-default-width)}.ck.ck-form:focus{outline:none}.ck.ck-form .ck.ck-input-number,.ck.ck-form .ck.ck-input-text{min-width:100%;width:0}.ck.ck-form .ck.ck-dropdown{min-width:100%}.ck.ck-form .ck.ck-dropdown .ck-dropdown__button:not(:focus){border:1px solid var(--ck-color-base-border)}.ck.ck-form .ck.ck-dropdown .ck-dropdown__button .ck-button__label{width:100%}@media screen and (max-width:600px){.ck.ck-form.ck-responsive-form .ck.ck-form__row.ck-form__row_with-submit{align-items:stretch;flex-direction:column;padding:0}.ck.ck-form.ck-responsive-form .ck.ck-form__row.ck-form__row_with-submit>.ck{margin:var(--ck-spacing-large) var(--ck-spacing-large) 0}.ck.ck-form.ck-responsive-form .ck.ck-form__row.ck-form__row_with-submit .ck-button_with-text{justify-content:center}.ck.ck-form.ck-responsive-form .ck.ck-form__row.ck-form__row_large-bottom-padding{padding-bottom:var(--ck-spacing-large)}}[dir=ltr] .ck.ck-form.ck-responsive-form>:not(:first-child),[dir=rtl] .ck.ck-form.ck-responsive-form>:not(:last-child){margin-left:0}"),Y(".ck.ck-form.ck-emoji-picker-form{padding-bottom:0}.ck.ck-form.ck-emoji-picker-form .ck.ck-dropdown .ck-dropdown__button:not(:focus){border-color:transparent}");/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class st extends ie{backButtonView;focusTracker=new he;keystrokes=new me;children;_focusables=new xt;_focusCycler;constructor(e){super(e),this.backButtonView=this._createBackButton(),this.children=this.createCollection([this._createHeaderView()]),this._focusCycler=new Ve({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form","ck-emoji-picker-form","ck-responsive-form"],tabindex:"-1"},children:this.children})}render(){super.render(),[...this.children.filter(Et),this.backButtonView].forEach(i=>{this._focusables.add(i),this.focusTracker.add(i.element),Vt(i)&&this._focusCycler.chain(i.focusCycler)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBackButton(){const e=this.locale.t,i=new ge(this.locale);return i.set({class:"ck-button-back",label:e("Back"),icon:Bt,tooltip:!0}),i.delegate("execute").to(this,"cancel"),i}_createHeaderView(){const e=this.locale.t,i=new It(this.locale,{label:e("Emoji picker")});return i.children.add(this.backButtonView,0),i}}Y(".ck.ck-emoji{width:320px}.ck .ck.ck-emoji__search{align-items:center;display:flex;justify-content:space-between;padding:var(--ck-spacing-large);padding-bottom:var(--ck-spacing-medium)}.ck .ck.ck-emoji__search>.ck.ck-search{flex:1}.ck .ck-fake-emoji-selection{background:var(--ck-color-link-fake-selection)}.ck .ck-fake-emoji-selection_collapsed{border-right:1px solid var(--ck-color-base-text);height:100%;margin-right:-1px;outline:1px solid hsla(0,0%,100%,.5)}div.ck.ck-balloon-panel.ck-emoji-picker-balloon{z-index:calc(var( --ck-z-dialog ) + 1)}");/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/const $="emoji-picker";class ot extends se{static get requires(){return[X,St,Pt,Ne]}static get pluginName(){return"EmojiPicker"}static get isOfficialPlugin(){return!0}async init(){const e=this.editor;if(this.balloonPlugin=e.plugins.get("ContextualBalloon"),this.emojiRepositoryPlugin=e.plugins.get("EmojiRepository"),!await this.emojiRepositoryPlugin.isReady())return;const i=new Xe(e);e.commands.add("emoji",i),e.ui.componentFactory.add("emoji",()=>{const r=this._createButton(ge,i);return r.set({tooltip:!0}),r}),e.ui.componentFactory.add("menuBar:emoji",()=>this._createButton(Tt,i)),this._setupConversion()}destroy(){super.destroy(),this.emojiPickerView&&this.emojiPickerView.destroy()}get skinTone(){return this.emojiPickerView?this.emojiPickerView.gridView.skinTone:this.editor.config.get("emoji.skinTone")}showUI(e=""){this._showFakeVisualSelection(),this.emojiPickerView||(this.emojiPickerView=this._createEmojiPickerView()),e&&this.emojiPickerView.searchView.setInputValue(e),this.emojiPickerView.searchView.search(e),this.emojiPickerFormView||(this.emojiPickerFormView=this._createEmojiPickerFormView()),this.balloonPlugin.hasView(this.emojiPickerFormView)||(this.emojiPickerFormView.backButtonView.isVisible=!!this.balloonPlugin.visibleView,this.balloonPlugin.add({view:this.emojiPickerFormView,position:this._getBalloonPositionData(),balloonClassName:"ck-emoji-picker-balloon"})),this.emojiPickerView.focus()}_createButton(e,i){const r=new e(this.editor.locale),n=this.editor.locale.t;return r.bind("isEnabled").to(i,"isEnabled"),r.set({label:n("Emoji"),icon:Lt,isToggleable:!0}),r.on("execute",()=>{this.editor.editing.view.scrollToTheSelection(),this.showUI()}),r}_createEmojiPickerView(){const e=new nt(this.editor.locale,{emojiCategories:this.emojiRepositoryPlugin.getEmojiCategories(),skinTone:this.editor.config.get("emoji.skinTone"),skinTones:this.emojiRepositoryPlugin.getSkinTones(),getEmojiByQuery:i=>this.emojiRepositoryPlugin.getEmojiByQuery(i)});return this.listenTo(e.gridView,"execute",(i,r)=>{const n=this.editor,l=r.emoji;this._hideUI(),n.execute("insertText",{text:l})}),e}_createEmojiPickerFormView(){const e=new st(this.editor.locale);return e.children.add(this.emojiPickerView),this.listenTo(this.emojiPickerView,"update",()=>{this.balloonPlugin.visibleView===e&&this.balloonPlugin.updatePosition()}),this.listenTo(e,"cancel",()=>{this._hideUI()}),e.keystrokes.set("Esc",(i,r)=>{this._hideUI(),r()}),At({emitter:e,contextElements:[this.balloonPlugin.view.element],callback:()=>{this._hideUI(!1)},activator:()=>this.balloonPlugin.visibleView===e}),e}_hideUI(e=!0){this.balloonPlugin.remove(this.emojiPickerFormView),this.emojiPickerView.searchView.setInputValue(""),e&&this.editor.editing.view.focus(),this._hideFakeVisualSelection()}_setupConversion(){const e=this.editor;e.conversion.for("editingDowncast").markerToHighlight({model:$,view:{classes:["ck-fake-emoji-selection"]}}),e.conversion.for("editingDowncast").markerToElement({model:$,view:(i,{writer:r})=>{if(!i.markerRange.isCollapsed)return null;const n=r.createUIElement("span");return r.addClass(["ck-fake-emoji-selection","ck-fake-emoji-selection_collapsed"],n),n}})}_getBalloonPositionData(){const e=this.editor.editing.view,i=e.document;return{target:()=>e.domConverter.viewRangeToDom(i.selection.getFirstRange())}}_showFakeVisualSelection(){const e=this.editor.model;e.change(i=>{const r=e.document.selection.getFirstRange();if(e.markers.has($))i.updateMarker($,{range:r});else if(r.start.isAtEnd){const n=r.start.getLastMatchingPosition(({item:l})=>!e.schema.isContent(l),{boundaries:r});i.addMarker($,{usingOperation:!1,affectsData:!1,range:i.createRange(n,r.end)})}else i.addMarker($,{usingOperation:!1,affectsData:!1,range:r})})}_hideFakeVisualSelection(){const e=this.editor.model;e.markers.has($)&&e.change(i=>{i.removeMarker($)})}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class Mi extends se{static get requires(){return[Ye,ot]}static get pluginName(){return"Emoji"}static get isOfficialPlugin(){return!0}}export{Mi as Emoji,tt as EmojiCategoriesView,Xe as EmojiCommand,et as EmojiGridView,Ye as EmojiMention,ot as EmojiPicker,st as EmojiPickerFormView,nt as EmojiPickerView,X as EmojiRepository,it as EmojiSearchView,rt as EmojiToneView,we as EmojiUtils,Ze as _isEmojiSupported};
