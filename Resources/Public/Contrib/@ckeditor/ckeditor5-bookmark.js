import{Command as v,Plugin as f}from"@ckeditor/ckeditor5-core";import{toWidget as S,WidgetToolbarRepository as _,isWidget as A,Widget as P}from"@ckeditor/ckeditor5-widget";import{View as N,ViewCollection as M,FormRowView as R,FocusCycler as L,submitHandler as U,ButtonView as d,FormHeaderView as D,LabeledFieldView as O,createLabeledInputText as W,IconView as H,ContextualBalloon as B,BalloonPanelView as j,CssTransitionDisablerMixin as $,MenuBarMenuListItemButtonView as z,LabelView as K,clickOutsideHandler as q}from"@ckeditor/ckeditor5-ui";import{IconPreviousArrow as G,IconBookmarkInline as J,IconPencil as Q,IconRemove as X,IconBookmark as Y,IconBookmarkMedium as Z,IconBookmarkSmall as ee}from"@ckeditor/ckeditor5-icons";import{FocusTracker as te,KeystrokeHandler as oe,logWarning as V}from"@ckeditor/ckeditor5-utils";function u(a,{insertAt:e}={}){if(!a||typeof document>"u")return;const t=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",window.litNonce&&o.setAttribute("nonce",window.litNonce),e==="top"&&t.firstChild?t.insertBefore(o,t.firstChild):t.appendChild(o),o.styleSheet?o.styleSheet.cssText=a:o.appendChild(document.createTextNode(a))}u('.ck-vertical-form .ck-button:after{bottom:-1px;content:"";position:absolute;right:-1px;top:-1px;width:0;z-index:1}.ck-vertical-form .ck-button:focus:after{display:none}@media screen and (max-width:600px){.ck.ck-responsive-form .ck-button:after{bottom:-1px;content:"";position:absolute;right:-1px;top:-1px;width:0;z-index:1}.ck.ck-responsive-form .ck-button:focus:after{display:none}}.ck-vertical-form>.ck-button:nth-last-child(2):after{border-right:1px solid var(--ck-color-base-border)}.ck.ck-responsive-form{padding:var(--ck-spacing-large)}.ck.ck-responsive-form:focus{outline:none}[dir=ltr] .ck.ck-responsive-form>:not(:first-child),[dir=rtl] .ck.ck-responsive-form>:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-responsive-form{padding:0;width:calc(var(--ck-input-width)*.8)}.ck.ck-responsive-form .ck-labeled-field-view{margin:var(--ck-spacing-large) var(--ck-spacing-large) 0}.ck.ck-responsive-form .ck-labeled-field-view .ck-input-number,.ck.ck-responsive-form .ck-labeled-field-view .ck-input-text{min-width:0;width:100%}.ck.ck-responsive-form .ck-labeled-field-view .ck-labeled-field-view__error{white-space:normal}.ck.ck-responsive-form>.ck-button:nth-last-child(2):after{border-right:1px solid var(--ck-color-base-border)}.ck.ck-responsive-form>.ck-button:last-child,.ck.ck-responsive-form>.ck-button:nth-last-child(2){border-radius:0;margin-top:var(--ck-spacing-large);padding:var(--ck-spacing-standard)}.ck.ck-responsive-form>.ck-button:last-child:not(:focus),.ck.ck-responsive-form>.ck-button:nth-last-child(2):not(:focus){border-top:1px solid var(--ck-color-base-border)}[dir=ltr] .ck.ck-responsive-form>.ck-button:last-child,[dir=ltr] .ck.ck-responsive-form>.ck-button:nth-last-child(2),[dir=rtl] .ck.ck-responsive-form>.ck-button:last-child,[dir=rtl] .ck.ck-responsive-form>.ck-button:nth-last-child(2){margin-left:0}[dir=rtl] .ck.ck-responsive-form>.ck-button:last-child:last-of-type,[dir=rtl] .ck.ck-responsive-form>.ck-button:nth-last-child(2):last-of-type{border-right:1px solid var(--ck-color-base-border)}}'),u(":root{--ck-form-default-width:340px}.ck.ck-form{padding:0 0 var(--ck-spacing-large)}.ck.ck-form.ck-form_default-width{width:var(--ck-form-default-width)}.ck.ck-form:focus{outline:none}.ck.ck-form .ck.ck-input-number,.ck.ck-form .ck.ck-input-text{min-width:100%;width:0}.ck.ck-form .ck.ck-dropdown{min-width:100%}.ck.ck-form .ck.ck-dropdown .ck-dropdown__button:not(:focus){border:1px solid var(--ck-color-base-border)}.ck.ck-form .ck.ck-dropdown .ck-dropdown__button .ck-button__label{width:100%}@media screen and (max-width:600px){.ck.ck-form.ck-responsive-form .ck.ck-form__row.ck-form__row_with-submit{align-items:stretch;flex-direction:column;padding:0}.ck.ck-form.ck-responsive-form .ck.ck-form__row.ck-form__row_with-submit>.ck{margin:var(--ck-spacing-large) var(--ck-spacing-large) 0}.ck.ck-form.ck-responsive-form .ck.ck-form__row.ck-form__row_with-submit .ck-button_with-text{justify-content:center}.ck.ck-form.ck-responsive-form .ck.ck-form__row.ck-form__row_large-bottom-padding{padding-bottom:var(--ck-spacing-large)}}[dir=ltr] .ck.ck-form.ck-responsive-form>:not(:first-child),[dir=rtl] .ck.ck-form.ck-responsive-form>:not(:last-child){margin-left:0}"),u(":root{--ck-bookmark-form-width:340px}@media screen and (max-width:600px){:root{--ck-bookmark-form-width:300px}}.ck.ck-bookmark-form{width:var(--ck-bookmark-form-width)}");/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class E extends N{focusTracker=new te;keystrokes=new oe;idInputView;backButtonView;saveButtonView;children;_validators;_focusables=new M;_focusCycler;constructor(e,t){super(e),this._validators=t,this.backButtonView=this._createBackButton(),this.saveButtonView=this._createSaveButton(),this.idInputView=this._createIdInput(),this.children=this.createCollection([this._createHeaderView()]),this.children.add(new R(e,{children:[this.idInputView,this.saveButtonView],class:["ck-form__row_with-submit","ck-form__row_large-top-padding"]})),this.keystrokes.set("Esc",(o,i)=>{this.fire("cancel"),i()}),this._focusCycler=new L({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-bookmark-form","ck-responsive-form"],tabindex:"-1"},children:this.children})}render(){super.render(),U({view:this}),[this.backButtonView,this.idInputView,this.saveButtonView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.idInputView.focus()}isValid(){this.resetFormStatus();for(const e of this._validators){const t=e(this);if(t)return this.idInputView.errorText=t,!1}return!0}resetFormStatus(){this.idInputView.errorText=null}_createBackButton(){const e=this.locale.t,t=new d(this.locale);return t.set({class:"ck-button-back",label:e("Back"),icon:G,tooltip:!0}),t.delegate("execute").to(this,"cancel"),t}_createSaveButton(){const e=this.locale.t,t=new d(this.locale);return t.set({label:e("Save"),withText:!0,type:"submit",class:"ck-button-action ck-button-bold"}),t}_createHeaderView(){const e=this.locale.t,t=new D(this.locale,{label:e("Bookmark")});return t.children.add(this.backButtonView,0),t}_createIdInput(){const e=this.locale.t,t=new O(this.locale,W);return t.label=e("Bookmark name"),t.infoText=e("Enter the bookmark name without spaces."),t.class="ck-labeled-field-view_full-width",t}get id(){const{element:e}=this.idInputView.fieldView;return e?e.value.trim():null}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function b(a){return!(!a||typeof a!="string"||/\s/.test(a))}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class I extends v{refresh(){const t=this.editor.model.document.selection,o=this._getPositionToInsertBookmark(t);this.isEnabled=!!o}execute(e){if(!e)return;const{bookmarkId:t}=e;if(!b(t)){V("insert-bookmark-command-executed-with-invalid-name");return}const o=this.editor,i=o.model,r=i.document.selection;i.change(s=>{let n=this._getPositionToInsertBookmark(r);if(!i.schema.checkChild(n,"bookmark")){const h=o.execute("insertParagraph",{position:n});if(!h)return;n=h}const l=s.createElement("bookmark",{...Object.fromEntries(r.getAttributes()),bookmarkId:t});i.insertObject(l,n,null,{setSelection:"on"})})}_getPositionToInsertBookmark(e){const t=this.editor.model,o=t.schema,i=e.getFirstRange(),r=i.start;if(w(r,o))return r;for(const{previousPosition:s,item:n}of i){if(n.is("element")&&o.checkChild(n,"$text")&&w(n,o))return t.createPositionAt(n,0);if(w(s,o))return s}return null}}function w(a,e){return e.checkChild(a,"bookmark")?!0:e.checkChild(a,"paragraph")?e.checkChild("paragraph","bookmark"):!1}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class x extends v{refresh(){const t=this.editor.model.document.selection,o=y(t);this.isEnabled=!!o,this.value=o?o.getAttribute("bookmarkId"):void 0}execute(e){if(!e)return;const{bookmarkId:t}=e;if(!b(t)){V("update-bookmark-command-executed-with-invalid-name");return}const o=this.editor.model,i=o.document.selection,r=y(i);r&&o.change(s=>{s.setAttribute("bookmarkId",t,r)})}}function y(a){const e=a.getSelectedElement();return e&&e.is("element","bookmark")?e:null}u(":root{--ck-bookmark-icon-hover-fill-color:var(--ck-color-widget-hover-border);--ck-bookmark-icon-selected-fill-color:var(--ck-color-focus-border);--ck-bookmark-icon-animation-duration:var(--ck-widget-handler-animation-duration);--ck-bookmark-icon-animation-curve:var(--ck-widget-handler-animation-curve)}.ck .ck-bookmark.ck-widget{display:inline-block;outline:none}.ck .ck-bookmark.ck-widget .ck-bookmark__icon .ck-icon__fill{transition:fill var(--ck-bookmark-icon-animation-duration) var(--ck-bookmark-icon-animation-curve)}.ck .ck-bookmark.ck-widget:hover .ck-bookmark__icon .ck-icon__fill{fill:var(--ck-bookmark-icon-hover-fill-color)}.ck .ck-bookmark.ck-widget.ck-widget_selected .ck-bookmark__icon .ck-icon__fill{fill:var(--ck-bookmark-icon-selected-fill-color)}.ck .ck-bookmark.ck-widget.ck-widget_selected,.ck .ck-bookmark.ck-widget.ck-widget_selected:hover{outline:none}.ck .ck-bookmark.ck-widget .ck-bookmark__icon{display:block;position:relative;top:-.1em}.ck .ck-bookmark.ck-widget .ck-bookmark__icon .ck-icon{height:1.2em;vertical-align:middle;width:auto}.ck .ck-fake-bookmark-selection{background:var(--ck-color-link-fake-selection)}.ck .ck-fake-bookmark-selection_collapsed{border-right:1px solid var(--ck-color-base-text);height:100%;margin-right:-1px;outline:1px solid hsla(0,0%,100%,.5)}");/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class m extends f{_bookmarkElements=new Map;static get pluginName(){return"BookmarkEditing"}static get licenseFeatureCode(){return"BKM"}static get isOfficialPlugin(){return!0}static get isPremiumPlugin(){return!0}constructor(e){super(e),e.config.define("bookmark",{toolbar:["bookmarkPreview","|","editBookmark","removeBookmark"]})}init(){const{editor:e}=this;this._defineSchema(),this._defineConverters(),e.commands.add("insertBookmark",new I(e)),e.commands.add("updateBookmark",new x(e)),this.listenTo(e.model.document,"change:data",()=>{this._trackBookmarkElements()})}getElementForBookmarkId(e){for(const[t,o]of this._bookmarkElements)if(o==e)return t;return null}getAllBookmarkNames(){return new Set(this._bookmarkElements.values())}_defineSchema(){this.editor.model.schema.register("bookmark",{inheritAllFrom:"$inlineObject",allowAttributes:"bookmarkId",disallowAttributes:["linkHref","htmlA"]})}_defineConverters(){const{editor:e}=this,{conversion:t,t:o}=e;e.data.htmlProcessor.domConverter.registerInlineObjectMatcher(i=>g(i)),e.editing.view.domConverter.registerInlineObjectMatcher(i=>g(i,!1)),t.for("dataDowncast").elementToElement({model:{name:"bookmark",attributes:["bookmarkId"]},view:(i,{writer:r})=>r.createEmptyElement("a",{id:i.getAttribute("bookmarkId")})}),t.for("editingDowncast").elementToElement({model:{name:"bookmark",attributes:["bookmarkId"]},view:(i,{writer:r})=>{const s=i.getAttribute("bookmarkId"),n=r.createContainerElement("a",{id:s,class:"ck-bookmark"},[this._createBookmarkUIElement(r)]);return r.setCustomProperty("bookmark",!0,n),this._bookmarkElements.set(i,s),S(n,r,{label:()=>`${s} ${o("bookmark widget")}`})}}),t.for("upcast").add(i=>i.on("element:a",ie(e)))}_createBookmarkUIElement(e){return e.createUIElement("span",{class:"ck-bookmark__icon"},function(t){const o=this.toDomElement(t),i=new H;return i.set({content:J,isColorInherited:!1}),i.render(),o.appendChild(i.element),o})}_trackBookmarkElements(){this._bookmarkElements.forEach((e,t)=>{t.root.rootName==="$graveyard"&&this._bookmarkElements.delete(t)})}}function g(a,e=!0){if(!(a.name==="a")||e&&!a.isEmpty)return null;const o=a.hasAttribute("id"),i=a.hasAttribute("name"),r=a.hasAttribute("href");return o&&!r?{name:!0,attributes:["id"]}:i&&!r?{name:!0,attributes:["name"]}:null}function ie(a){return(e,t,o)=>{const i=t.viewItem,r=g(i,!1);if(!r||!o.consumable.test(i,r)||!re(a)&&!i.isEmpty)return;const n=o.writer,c=i.getAttribute("id"),l=i.getAttribute("name"),h=c||l,p=n.createElement("bookmark",{bookmarkId:h});if(!o.safeInsert(p,t.modelCursor))return;o.consumable.consume(i,r),c===l&&o.consumable.consume(i,{attributes:["name"]}),o.updateConversionResult(p,t);const{modelCursor:T,modelRange:F}=o.convertChildren(i,t.modelCursor);t.modelCursor=T,t.modelRange=n.createRange(t.modelRange.start,F.end)}}function re(a){const e=a.config.get("bookmark.enableNonEmptyAnchorConversion");return e!==void 0?e:!0}u(".ck.ck-bookmark-balloon .ck.ck-toolbar>.ck-toolbar__items{flex-wrap:nowrap}.ck.ck-bookmark-toolbar__preview{cursor:default;font-weight:400;max-width:var(--ck-input-width);min-width:3em;overflow:hidden;padding:0 var(--ck-spacing-medium);text-align:center;text-overflow:ellipsis;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}");/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/const k="bookmark-ui";class C extends f{formView=null;_balloon;static get requires(){return[m,B,_]}static get pluginName(){return"BookmarkUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;this._balloon=e.plugins.get(B),e.plugins.has("LinkUI")&&this._registerLinkProvider(),this._registerComponents(),e.conversion.for("editingDowncast").markerToHighlight({model:k,view:{classes:["ck-fake-bookmark-selection"]}}),e.conversion.for("editingDowncast").markerToElement({model:k,view:(t,{writer:o})=>{if(!t.markerRange.isCollapsed)return null;const i=o.createUIElement("span");return o.addClass(["ck-fake-bookmark-selection","ck-fake-bookmark-selection_collapsed"],i),i}})}afterInit(){const e=this.editor,t=e.locale.t,o=this.editor.plugins.get(_),i=j.defaultPositions;o.register("bookmark",{ariaLabel:t("Bookmark toolbar"),items:e.config.get("bookmark.toolbar"),getRelatedElement:se,balloonClassName:"ck-bookmark-balloon ck-toolbar-container",positions:[i.southArrowNorth,i.southArrowNorthMiddleWest,i.southArrowNorthMiddleEast,i.southArrowNorthWest,i.southArrowNorthEast,i.northArrowSouth,i.northArrowSouthMiddleWest,i.northArrowSouthMiddleEast,i.northArrowSouthWest,i.northArrowSouthEast,i.viewportStickyNorth]})}destroy(){super.destroy(),this.formView&&this.formView.destroy()}_createViews(){this.formView=this._createFormView(),this._enableUserBalloonInteractions()}_createFormView(){const e=this.editor,t=e.locale,o=t.t,i=e.commands.get("insertBookmark"),r=e.commands.get("updateBookmark"),s=[i,r],n=new($(E))(t,ne(e));return n.idInputView.fieldView.bind("value").to(r,"value"),n.saveButtonView.bind("label").to(r,"value",c=>o(c?"Save":"Insert")),n.idInputView.bind("isEnabled").toMany(s,"isEnabled",(...c)=>c.some(l=>l)),n.saveButtonView.bind("isEnabled").toMany(s,"isEnabled",(...c)=>c.some(l=>l)),this.listenTo(n,"cancel",()=>{this._hideFormView()}),this.listenTo(n,"submit",()=>{if(n.isValid()){const c=n.id;this._getSelectedBookmarkElement()?e.execute("updateBookmark",{bookmarkId:c}):e.execute("insertBookmark",{bookmarkId:c}),this._hideFormView()}}),this.listenTo(n.idInputView,"change:errorText",()=>{e.ui.update()}),n}_registerLinkProvider(){const e=this.editor.locale.t,t=this.editor.plugins.get("LinkUI"),o=this.editor.plugins.get(m),i=()=>Array.from(o.getAllBookmarkNames()).sort((s,n)=>s.localeCompare(n)).map(s=>({id:s,href:`#${s}`,label:s,icon:Z})),r=s=>{const n=[...o.getAllBookmarkNames()].find(c=>`#${c}`===s);return n?{href:s,label:n,icon:ee,tooltip:e("Scroll to bookmark")}:null};t.registerLinksListProvider({label:e("Bookmarks"),emptyListPlaceholder:e("No bookmarks available."),navigate:({href:s})=>this._scrollToBookmark(s),getListItems:i,getItem:r})}_scrollToBookmark(e){const o=this.editor.plugins.get(m).getElementForBookmarkId(e.slice(1));return o?(this.editor.model.change(i=>{i.setSelection(o,"on")}),this.editor.editing.view.scrollToTheSelection({alignToTop:!0,forceScroll:!0}),!0):!1}_registerComponents(){const e=this.editor;e.ui.componentFactory.add("bookmark",()=>{const t=this._createBookmarkButton(d);return t.set({tooltip:!0}),t}),e.ui.componentFactory.add("menuBar:bookmark",()=>this._createBookmarkButton(z)),e.ui.componentFactory.add("bookmarkPreview",t=>{const o=e.commands.get("updateBookmark"),i=new K(t);return i.extendTemplate({attributes:{class:["ck-bookmark-toolbar__preview"]}}),i.bind("text").to(o,"value"),i}),e.ui.componentFactory.add("editBookmark",t=>{const o=e.commands.get("updateBookmark"),i=new d(t),r=t.t;return i.set({label:r("Edit bookmark"),icon:Q,tooltip:!0}),i.bind("isEnabled").to(o),this.listenTo(i,"execute",()=>{this._showFormView()}),i}),e.ui.componentFactory.add("removeBookmark",t=>{const o=e.commands.get("delete"),i=new d(t),r=t.t;return i.set({label:r("Remove bookmark"),icon:X,tooltip:!0}),i.bind("isEnabled").to(o),this.listenTo(i,"execute",()=>{e.execute("delete"),e.editing.view.focus()}),i})}_createBookmarkButton(e){const t=this.editor,o=t.locale,i=new e(o),r=t.commands.get("insertBookmark"),s=t.commands.get("updateBookmark"),n=o.t;return i.set({label:n("Bookmark"),icon:Y}),this.listenTo(i,"execute",()=>{t.editing.view.scrollToTheSelection(),this._showFormView()}),i.bind("isEnabled").toMany([r,s],"isEnabled",(...c)=>c.some(l=>l)),i.bind("isOn").to(s,"value",c=>!!c),i}_enableUserBalloonInteractions(){this.editor.keystrokes.set("Esc",(e,t)=>{this._isFormVisible&&(this._hideFormView(),t())}),q({emitter:this.formView,activator:()=>this._isFormInPanel,contextElements:()=>[this._balloon.view.element],callback:()=>{this._hideFormView(!1)}})}_addFormView(){if(this.formView||this._createViews(),this._isFormInPanel)return;const e=this.editor.commands.get("updateBookmark");this.formView.disableCssTransitions(),this.formView.resetFormStatus(),this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this.formView.backButtonView.isVisible=e.isEnabled,this.formView.idInputView.fieldView.value=e.value||"",this._balloon.visibleView===this.formView&&this.formView.idInputView.fieldView.select(),this.formView.enableCssTransitions()}_removeFormView(e=!0){this.formView.saveButtonView.focus(),this.formView.idInputView.fieldView.reset(),this._balloon.remove(this.formView),e&&this.editor.editing.view.focus(),this._hideFakeVisualSelection()}_showFormView(){this.formView||this._createViews(),this._getSelectedBookmarkElement()||this._showFakeVisualSelection(),this._addFormView(),this._balloon.showStack("main"),this._startUpdatingUI()}_hideFormView(e=!0){if(!this._isFormInPanel)return;const t=this.editor;this.stopListening(t.ui,"update"),this.stopListening(this._balloon,"change:visibleView"),e&&t.editing.view.focus(),this._removeFormView(e),this._hideFakeVisualSelection()}_startUpdatingUI(){const e=this.editor,t=e.editing.view.document;let o=this._getSelectedBookmarkElement(),i=s();const r=()=>{const n=this._getSelectedBookmarkElement(),c=s();o&&!n||!o&&c!==i?this._hideFormView():this._isFormVisible&&this._balloon.updatePosition(this._getBalloonPositionData()),o=n,i=c};function s(){return t.selection.focus.getAncestors().reverse().find(n=>n.is("element"))}this.listenTo(e.ui,"update",r),this.listenTo(this._balloon,"change:visibleView",r)}get _isFormInPanel(){return!!this.formView&&this._balloon.hasView(this.formView)}get _isFormVisible(){return!!this.formView&&this._balloon.visibleView==this.formView}_getBalloonPositionData(){const e=this.editor.editing.view,t=this.editor.model;let o;const i=this._getSelectedBookmarkElement();if(t.markers.has(k)){const r=Array.from(this.editor.editing.mapper.markerNameToElements(k)),s=e.createRange(e.createPositionBefore(r[0]),e.createPositionAfter(r[r.length-1]));o=e.domConverter.viewRangeToDom(s)}else i&&(o=()=>{const r=this.editor.editing.mapper,s=e.domConverter,n=r.toViewElement(i);return s.mapViewToDom(n)});if(o)return{target:o}}_getSelectedBookmarkElement(){const t=this.editor.model.document.selection.getSelectedElement();return t&&t.is("element","bookmark")?t:null}_showFakeVisualSelection(){const e=this.editor.model;e.change(t=>{const o=e.document.selection.getFirstRange();if(e.markers.has(k))t.updateMarker(k,{range:o});else if(o.start.isAtEnd){const i=o.start.getLastMatchingPosition(({item:r})=>!e.schema.isContent(r),{boundaries:o});t.addMarker(k,{usingOperation:!1,affectsData:!1,range:t.createRange(i,o.end)})}else t.addMarker(k,{usingOperation:!1,affectsData:!1,range:o})})}_hideFakeVisualSelection(){const e=this.editor.model;e.markers.has(k)&&e.change(t=>{t.removeMarker(k)})}}function ne(a){const{t:e}=a,t=a.plugins.get(m);return[o=>{if(!o.id)return e("Bookmark must not be empty.")},o=>{if(o.id&&/\s/.test(o.id))return e("Bookmark name cannot contain space characters.")},o=>{const i=a.model.document.selection.getSelectedElement(),r=t.getElementForBookmarkId(o.id);if(i!==r&&r)return e("Bookmark name already exists.")}]}function se(a){const e=a.getSelectedElement();return!e||!A(e)||!e.getCustomProperty("bookmark")?null:e}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class ae extends f{static get pluginName(){return"Bookmark"}static get requires(){return[m,C,P]}static get isOfficialPlugin(){return!0}}export{ae as Bookmark,m as BookmarkEditing,E as BookmarkFormView,C as BookmarkUI,I as InsertBookmarkCommand,x as UpdateBookmarkCommand,b as _isBookmarkIdValid};
