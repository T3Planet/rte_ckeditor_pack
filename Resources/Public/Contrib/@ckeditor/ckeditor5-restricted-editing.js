import{Command as x,Plugin as E}from"@ckeditor/ckeditor5-core";import{getCode as j,parseKeystroke as z,Collection as J,first as y}from"@ckeditor/ckeditor5-utils";import{Matcher as M}from"@ckeditor/ckeditor5-engine";import{IconContentLock as B,IconContentUnlock as P}from"@ckeditor/ckeditor5-icons";import{createDropdown as A,addListToDropdown as Q,MenuBarMenuView as X,MenuBarMenuListView as Y,MenuBarMenuListItemView as Z,MenuBarMenuListItemButtonView as b,UIModel as ee,addToolbarToDropdown as te,ButtonView as I}from"@ckeditor/ckeditor5-ui";/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function u(s,e){for(const n of s.model.markers){const t=h(n,s.model);if(k(t,e)&&n.name.startsWith("restrictedEditingException:"))return n}}function k(s,e){return s.containsPosition(e)||s.end.isEqual(e)||s.start.isEqual(e)}function D(s,e,n){if(!n)return!1;const t=h(n,e);return s.isCollapsed?k(t,s.focus):t.containsRange(s.getFirstRange(),!0)}function h(s,e){const n=s.getRange(),t=n.getContainedElement();return t&&t.is("element","restrictedEditingException")?e.createRangeIn(t):n}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class w extends x{_direction;constructor(e,n){super(e),this.affectsData=!1,this._direction=n}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=F(this.editor.model,this._direction);e&&this.editor.model.change(n=>{n.setSelection(e)})}_checkEnabled(){return!!F(this.editor.model,this._direction)}}function F(s,e){const t=s.document.selection.getFirstPosition(),i=[];for(const r of s.markers.getMarkersGroup("restrictedEditingException")){const o=h(r,s),c=t.isTouching(o.start)&&t.hasSameParentAs(o.start)||t.isTouching(o.end)&&t.hasSameParentAs(o.end);o.containsPosition(t)||c||(e==="forward"&&o.start.isAfter(t)||e==="backward"&&o.end.isBefore(t))&&i.push(o)}if(i.length)return i.sort((r,o)=>e==="forward"?r.start.isAfter(o.start)?1:-1:r.start.isBefore(o.start)?1:-1).shift()}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/const v="restricted-editing-exception_selected";function N(s){const e=s.editing.view,n=s.model,t=new Set;e.document.registerPostFixer(i=>{const r=n.document.selection,o=u(s,r.anchor);if(!o)return!1;const c=o.getRange().getContainedElement();if(c&&c.is("element","restrictedEditingException")){const d=s.editing.mapper.toViewElement(c);i.addClass(v,d),t.add(d)}else for(const d of s.editing.mapper.markerNameToElements(o.name))i.addClass(v,d),t.add(d);return!1}),s.conversion.for("editingDowncast").add(i=>{i.on("insert",r,{priority:"highest"}),i.on("remove",r,{priority:"highest"}),i.on("attribute",r,{priority:"highest"}),i.on("cleanSelection",r);function r(){e.change(o=>{for(const c of t.values())o.removeClass(v,c),t.delete(c)})}})}function V(s){return e=>{let n=!1;for(const{name:t,data:i}of s.model.document.differ.getChangedMarkers())t.startsWith("restrictedEditingException")&&i.newRange&&i.newRange.root.rootName=="$graveyard"&&(e.updateMarker(t,{range:e.createRange(e.createPositionAt(i.oldRange.start))}),n=!0);return n}}function O(s){return e=>{let n=!1;const t=s.model.schema;for(const i of s.model.document.differ.getChanges())i.type=="insert"&&t.checkChild("$block",i.name)&&(n=ie(s,i.position,i.length,e)||n,n=ne(s,i.position,i.length,e)||n);return n}}function _(s){return e=>e.on("element",(n,t,i)=>{const{writer:r}=i,c=new M(s.view).match(t.viewItem);if(!c)return;const d=c.match;if(d.name=!0,!i.consumable.test(t.viewItem,d))return;let a=t.modelCursor,g=null;if(s.useWrapperElement){if(!i.schema.checkChild(a,"restrictedEditingException"))return;g=r.createElement("restrictedEditingException"),r.insert(g,a),a=r.createPositionAt(g,0)}const{modelRange:l}=i.convertChildren(t.viewItem,a);i.consumable.consume(t.viewItem,d);const m=s.model(),f=r.createElement("$marker",{"data-name":m}),p=r.createElement("$marker",{"data-name":m});g?(r.insert(f,r.createPositionBefore(g)),r.insert(p,r.createPositionAfter(g))):(r.insert(p,l.end),r.insert(f,l.start)),t.modelRange=r.createRange(r.createPositionBefore(f),r.createPositionAfter(p)),t.modelCursor=t.modelRange.end})}function ie(s,e,n,t){const i=u(s,e.getShiftedBy(n));return i&&i.getStart().isEqual(e.getShiftedBy(n))?(t.updateMarker(i,{range:t.createRange(i.getStart().getShiftedBy(-n),i.getEnd())}),!0):!1}function ne(s,e,n,t){const i=u(s,e);return i&&i.getEnd().isEqual(e)?(t.updateMarker(i,{range:t.createRange(i.getStart(),i.getEnd().getShiftedBy(n))}),!0):!1}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/const C="RestrictedEditingMode";class W extends E{_alwaysEnabled;_allowedInException;static get pluginName(){return"RestrictedEditingModeEditing"}static get licenseFeatureCode(){return"RED"}static get isOfficialPlugin(){return!0}static get isPremiumPlugin(){return!0}constructor(e){super(e),e.config.define("restrictedEditing",{allowedCommands:["bold","italic","link","unlink"],allowedAttributes:["bold","italic","linkHref"]}),this._alwaysEnabled=new Set(["undo","redo"]),this._allowedInException=new Set(["input","insertText","delete","deleteForward"])}init(){const e=this.editor,n=e.editing.view;e.config.get("restrictedEditing.allowedCommands").forEach(i=>this._allowedInException.add(i)),this._setupSchema(),this._setupConversion(),this._setupCommandsToggling(),this._setupRestrictions(),e.commands.add("goToPreviousRestrictedEditingException",new w(e,"backward")),e.commands.add("goToNextRestrictedEditingException",new w(e,"forward")),this.listenTo(n.document,"tab",(i,r)=>{const o=r.shiftKey?"goToPreviousRestrictedEditingException":"goToNextRestrictedEditingException";e.commands.get(o).isEnabled&&(e.execute(o),r.preventDefault(),r.stopPropagation()),i.stop()},{context:"$capture"}),this.listenTo(n.document,"keydown",re(e),{priority:"high"}),n.change(i=>{for(const r of n.document.roots)i.addClass("ck-restricted-editing_mode_restricted",r)}),e.data.on("set",()=>{e.model.change(i=>{for(const r of e.model.markers.getMarkersGroup("restrictedEditingException"))i.removeMarker(r.name)})},{priority:"high"})}enableCommand(e){this.editor.commands.get(e).clearForceDisabled(C),this._alwaysEnabled.add(e)}_setupSchema(){this.editor.model.schema.register("restrictedEditingException",{allowWhere:"$block",allowContentOf:"$container",isLimit:!0})}_setupConversion(){const e=this.editor,t=e.model.document;let i=0;e.conversion.for("upcast").add(_({view:{name:"span",classes:"restricted-editing-exception"},model:()=>(i++,`restrictedEditingException:inline:${i}`)})),e.conversion.for("upcast").add(_({view:{name:"div",classes:"restricted-editing-exception"},model:()=>(i++,`restrictedEditingException:block:${i}`),useWrapperElement:!0})),e.conversion.for("downcast").elementToElement({model:"restrictedEditingException",view:{name:"div",classes:"restricted-editing-exception"}}),e.conversion.for("downcast").add(r=>{r.on("addMarker:restrictedEditingException:inline",(o,c,d)=>{if(!c.item||c.item.is("selection")||!d.schema.isInline(c.item)||!d.consumable.consume(c.item,o.name))return;const a=d.writer,g=a.createAttributeElement("span",{class:"restricted-editing-exception"},{id:c.markerName,priority:-10}),l=d.mapper.toViewRange(c.range),m=a.wrap(l,g);for(const f of m.getItems())if(f.is("attributeElement")&&f.isSimilar(g)){d.mapper.bindElementToMarker(f,c.markerName);break}})}),e.conversion.for("downcast").markerToHighlight({model:"restrictedEditingException:inline",view:()=>({name:"span",classes:"restricted-editing-exception",priority:-10})}),e.conversion.for("editingDowncast").markerToElement({model:"restrictedEditingException:inline",view:(r,{writer:o})=>o.createUIElement("span",{class:"restricted-editing-exception restricted-editing-exception_collapsed"})}),e.conversion.for("dataDowncast").markerToElement({model:"restrictedEditingException:inline",view:(r,{writer:o})=>o.createEmptyElement("span",{class:"restricted-editing-exception"})}),t.registerPostFixer(O(e)),t.registerPostFixer(V(e)),t.registerPostFixer(de(e)),N(e)}_setupRestrictions(){const e=this.editor,n=e.model,t=n.document.selection,i=e.editing.view.document,r=e.plugins.get("ClipboardPipeline");this.listenTo(n,"deleteContent",se(e),{priority:"high"});const o=e.commands.get("insertText");o&&this.listenTo(o,"execute",ce(e),{priority:"high"}),this.listenTo(r,"contentInsertion",(c,d)=>{R(e,t.getFirstRange())||c.stop();const a=u(e,t.focus);if(a&&a.name.startsWith("restrictedEditingException:inline:")){const g=e.config.get("restrictedEditing.allowedAttributes");n.change(l=>{const m=l.createDocumentFragment(),f=Array.from(l.createRangeIn(d.content).getItems()).filter(p=>p.is("$textProxy"));for(const p of f){for(const T of p.getAttributeKeys())g.includes(T)||l.removeAttribute(T,p);l.append(p,m)}d.content=m})}}),this.listenTo(i,"clipboardOutput",(c,d)=>{d.method=="cut"&&!R(e,t.getFirstRange())&&c.stop()},{priority:"high"}),n.schema.addChildCheck(c=>{if(c.startsWith("$clipboardHolder"))return!1},"restrictedEditingException")}_setupCommandsToggling(){const t=this.editor.model.document;this._disableCommands(),this.listenTo(t.selection,"change",this._checkCommands.bind(this)),this.listenTo(t,"change:data",this._checkCommands.bind(this))}_checkCommands(){const e=this.editor,n=e.model.document.selection;if(n.rangeCount>1){this._disableCommands();return}const t=u(e,n.focus);this._disableCommands(),D(n,e.model,t)&&this._enableCommands(t)}_enableCommands(e){const n=this.editor,t=n.model.document.selection;for(const[i,r]of n.commands)!r.affectsData||this._alwaysEnabled.has(i)||!e.name.startsWith("restrictedEditingException:block:")&&!this._allowedInException.has(i)||oe(i,t,h(e,n.model))||r.clearForceDisabled(C)}_disableCommands(){const e=this.editor;for(const[n,t]of e.commands)!t.affectsData||this._alwaysEnabled.has(n)||t.forceDisabled(C)}}function re(s){return(e,n)=>{if(j(n)!=z("Ctrl+A"))return;const t=s.model,i=s.model.document.selection,r=u(s,i.focus);if(!r)return;const o=i.getFirstRange(),c=h(r,s.model);(c.containsRange(o,!0)||i.isCollapsed)&&(e.stop(),n.preventDefault(),n.stopPropagation(),t.change(d=>{d.setSelection(c)}))}}function oe(s,e,n){return!!(s=="delete"&&e.isCollapsed&&n.start.isTouching(e.focus)||s=="deleteForward"&&e.isCollapsed&&n.end.isTouching(e.focus))}function se(s){return(e,n)=>{const[t]=n,i=u(s,t.focus)||u(s,t.anchor);if(!i){e.stop();return}if(t.isCollapsed)return;const r=h(i,s.model).getIntersection(t.getFirstRange());t.is("documentSelection")?s.model.change(o=>{o.setSelection(r)}):t.setTo(r)}}function ce(s){return(e,n)=>{const[t]=n,{range:i}=t;i&&(R(s,i)||e.stop())}}function R(s,e){const n=u(s,e.start),t=u(s,e.end);return n&&t&&t===n}function de(s){return e=>{let n=!1;const t=s.model.document.differ.getChangedMarkers();for(const{data:i,name:r}of t){if(!r.startsWith("restrictedEditingException"))continue;const o=i.newRange;if(!i.oldRange&&!o.isFlat){const c=o.start,d=o.end,a=c.path.length>d.path.length,g=a?o.start:e.createPositionAt(d.parent,0),l=a?e.createPositionAt(c.parent,"end"):o.end;e.updateMarker(r,{range:e.createRange(g,l)}),n=!0}}return n}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class $ extends E{static get pluginName(){return"RestrictedEditingModeUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,n=e.t;e.ui.componentFactory.add("restrictedEditing",t=>{const i=A(t),r=new J;return this._getButtonDefinitions().forEach(({commandName:o,label:c,keystroke:d})=>{r.add(this._getButtonDefinition(o,c,d))}),Q(i,r,{role:"menu"}),i.buttonView.set({label:n("Navigate editable regions"),icon:B,tooltip:!0,isEnabled:!0,isOn:!1}),this.listenTo(i,"execute",o=>{const{_commandName:c}=o.source;e.execute(c),e.editing.view.focus()}),i}),e.ui.componentFactory.add("menuBar:restrictedEditing",t=>{const i=new X(t),r=new Y(t);return r.set({ariaLabel:n("Navigate editable regions"),role:"menu"}),i.buttonView.set({label:n("Navigate editable regions"),icon:B}),i.panelView.children.add(r),this._getButtonDefinitions().forEach(({commandName:o,label:c,keystroke:d})=>{const a=new Z(t,i),g=this._createMenuBarButton(c,o,d);g.delegate("execute").to(i),a.children.add(g),r.items.add(a)}),i})}_createMenuBarButton(e,n,t){const i=this.editor,r=i.commands.get(n),o=new b(i.locale);return o.set({label:e,keystroke:t,isEnabled:!0,isOn:!1}),o.bind("isEnabled").to(r),this.listenTo(o,"execute",()=>{i.execute(n),i.editing.view.focus()}),o}_getButtonDefinition(e,n,t){const r=this.editor.commands.get(e),o={type:"button",model:new ee({label:n,withText:!0,keystroke:t,withKeystroke:!0,role:"menuitem",_commandName:e})};return o.model.bind("isEnabled").to(r,"isEnabled"),o}_getButtonDefinitions(){const e=this.editor.locale.t;return[{commandName:"goToPreviousRestrictedEditingException",label:e("Previous editable region"),keystroke:"Shift+Tab"},{commandName:"goToNextRestrictedEditingException",label:e("Next editable region"),keystroke:"Tab"}]}}function ae(s,{insertAt:e}={}){if(typeof document>"u")return;const n=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",window.litNonce&&t.setAttribute("nonce",window.litNonce),e==="top"&&n.firstChild?n.insertBefore(t,n.firstChild):n.appendChild(t),t.styleSheet?t.styleSheet.cssText=s:t.appendChild(document.createTextNode(s))}ae(":root{--ck-color-restricted-editing-exception-background:rgba(255,169,77,.2);--ck-color-restricted-editing-exception-hover-background:rgba(255,169,77,.35);--ck-color-restricted-editing-exception-brackets:rgba(204,105,0,.4);--ck-color-restricted-editing-selected-exception-background:rgba(255,169,77,.5);--ck-color-restricted-editing-selected-exception-brackets:rgba(204,105,0,.6)}.ck-editor__editable .restricted-editing-exception{background-color:var(--ck-color-restricted-editing-exception-background);border:1px solid;border-image:linear-gradient(to right,var(--ck-color-restricted-editing-exception-brackets) 0,var(--ck-color-restricted-editing-exception-brackets) 5px,transparent 6px,transparent calc(100% - 6px),var(--ck-color-restricted-editing-exception-brackets) calc(100% - 5px),var(--ck-color-restricted-editing-exception-brackets) 100%) 1;transition:background .2s ease-in-out}@media (prefers-reduced-motion:reduce){.ck-editor__editable .restricted-editing-exception{transition:none}}.ck-editor__editable .restricted-editing-exception.restricted-editing-exception_selected{background-color:var(--ck-color-restricted-editing-selected-exception-background);border-image:linear-gradient(to right,var(--ck-color-restricted-editing-selected-exception-brackets) 0,var(--ck-color-restricted-editing-selected-exception-brackets) 5px,var(--ck-color-restricted-editing-selected-exception-brackets) calc(100% - 5px),var(--ck-color-restricted-editing-selected-exception-brackets) 100%) 1}.ck-editor__editable .restricted-editing-exception.restricted-editing-exception_collapsed{padding-left:1ch}.ck-restricted-editing_mode_restricted,.ck-restricted-editing_mode_restricted *{cursor:default}.ck-restricted-editing_mode_restricted .restricted-editing-exception,.ck-restricted-editing_mode_restricted .restricted-editing-exception *{cursor:text}.ck-restricted-editing_mode_restricted .restricted-editing-exception:hover{background:var(--ck-color-restricted-editing-exception-hover-background)}");/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class le extends E{static get pluginName(){return"RestrictedEditingMode"}static get isOfficialPlugin(){return!0}static get requires(){return[W,$]}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class H extends x{refresh(){const e=this.editor.model,n=e.document;this.value=!!n.selection.getAttribute("restrictedEditingException"),this.isEnabled=e.schema.checkAttributeInSelection(n.selection,"restrictedEditingException")}execute(e={}){const n=this.editor.model,i=n.document.selection,r=e.forceValue===void 0?!this.value:e.forceValue;n.change(o=>{const c=n.schema.getValidRanges(i.getRanges(),"restrictedEditingException");if(i.isCollapsed)if(r)o.setSelectionAttribute("restrictedEditingException",r);else{const d=m=>m.item.getAttribute("restrictedEditingException")===this.value,a=i.focus,g=a.getLastMatchingPosition(d,{direction:"backward"}),l=a.getLastMatchingPosition(d);o.removeSelectionAttribute("restrictedEditingException"),a.isEqual(g)||a.isEqual(l)||o.removeAttribute("restrictedEditingException",o.createRange(g,l))}else for(const d of c)r?o.setAttribute("restrictedEditingException",r,d):o.removeAttribute("restrictedEditingException",d)})}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class L extends x{refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const n=this.editor.model,t=n.schema,i=n.document.selection,r=Array.from(i.getSelectedBlocks()),o=e.forceValue===void 0?!this.value:e.forceValue;n.change(c=>{if(o){const d=r.filter(a=>S(a)||q(t,a));this._applyException(c,d)}else{const d=r.map(a=>ge(a)).filter(a=>!!a);this._removeException(c,d)}})}_getValue(){const e=this.editor.model.document.selection,n=y(e.getSelectedBlocks());return!!(n&&S(n))}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,n=this.editor.model.schema,t=y(e.getSelectedBlocks());return t?q(n,t):!1}_removeException(e,n){U(e,n).reverse().forEach(t=>{if(t.start.isAtStart&&t.end.isAtEnd){e.unwrap(t.start.parent);return}if(t.start.isAtStart){const r=e.createPositionBefore(t.start.parent);e.move(t,r);return}t.end.isAtEnd||e.split(t.end);const i=e.createPositionAfter(t.end.parent);e.move(t,i)})}_applyException(e,n){const t=this.editor.model.schema,i=[];if(U(e,n).reverse().forEach(r=>{let o=S(r.start);o||(o=e.createElement("restrictedEditingException"),e.wrap(r,o)),i.push(o)}),i.reverse(),i.length){const r=i.at(0).previousSibling,o=i.at(-1).nextSibling;r?.is("element","restrictedEditingException")&&i.unshift(r),o?.is("element","restrictedEditingException")&&i.push(o)}i.reduce((r,o)=>r.nextSibling==o?(e.merge(e.createPositionAfter(r)),r):o),t.removeDisallowedAttributes(n,e)}}function S(s){return s.findAncestor("restrictedEditingException",{includeSelf:!0})}function ge(s){let e=s;for(;e.parent;){if(e.parent.name=="restrictedEditingException")return e;e=e.parent}return null}function U(s,e){let n,t=0;const i=[];for(;t<e.length;){const r=e[t],o=e[t+1];n||(n=s.createPositionBefore(r)),(!o||r.nextSibling!=o)&&(i.push(s.createRange(n,s.createPositionAfter(r))),n=null),t++}return i}function q(s,e){const n=s.createContext(e.parent);return!(!s.checkChild(n,"restrictedEditingException")||!s.checkChild(n.push("restrictedEditingException"),e))}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class G extends E{static get pluginName(){return"StandardEditingModeEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,n=e.model.schema;n.extend("$text",{allowAttributes:["restrictedEditingException"]}),n.register("restrictedEditingException",{allowWhere:"$container",allowContentOf:"$container"}),n.addChildCheck(t=>{for(const i of t)if(i.name=="restrictedEditingException")return!1},"restrictedEditingException"),n.addAttributeCheck(t=>{for(const i of t)if(i.name=="restrictedEditingException")return!1},"restrictedEditingException"),e.model.document.registerPostFixer(t=>{const i=e.model.document.differ.getChanges(),r=new Set,o=new Set,c=new Set;let d=!1;for(const a of i)if(a.type=="insert"){const g=t.createRange(a.position,a.position.getShiftedBy(a.length));for(const l of g.getItems())l.is("element","restrictedEditingException")?n.checkChild(t.createPositionBefore(l),l)?l.isEmpty?o.add(l):c.add(l):r.add(l):l.is("$textProxy")&&l.hasAttribute("restrictedEditingException")&&!n.checkAttribute(l,"restrictedEditingException")&&(t.removeAttribute("restrictedEditingException",l),d=!0)}else if(a.type=="remove"){const g=a.position.parent;g.is("element","restrictedEditingException")&&g.isEmpty&&o.add(g);for(const l of g.getChildren())l.is("element","restrictedEditingException")&&c.add(l)}for(const a of r)t.unwrap(a),d=!0;for(const a of o)t.remove(a),d=!0;for(const a of c){if(a.root.rootName=="$graveyard")continue;const g=a.previousSibling,l=a.nextSibling;g&&g.is("element","restrictedEditingException")&&t.merge(t.createPositionBefore(a)),l&&l.is("element","restrictedEditingException")&&t.merge(t.createPositionAfter(a))}return d}),e.conversion.for("upcast").elementToAttribute({model:"restrictedEditingException",view:{name:"span",classes:"restricted-editing-exception"}}).elementToElement({model:"restrictedEditingException",view:{name:"div",classes:"restricted-editing-exception"}}),ue(e),e.conversion.for("downcast").attributeToElement({model:"restrictedEditingException",view:(t,{writer:i})=>{if(t)return i.createAttributeElement("span",{class:"restricted-editing-exception"},{priority:-10})}}).elementToElement({model:"restrictedEditingException",view:{name:"div",classes:"restricted-editing-exception"}}),e.commands.add("restrictedEditingException",new H(e)),e.commands.add("restrictedEditingExceptionBlock",new L(e)),e.editing.view.change(t=>{for(const i of e.editing.view.document.roots)t.addClass("ck-restricted-editing_mode_standard",i)})}}function ue(s){const e=new M({name:"span",classes:"restricted-editing-exception"});s.conversion.for("upcast").add(n=>n.on("element:span",(t,i,r)=>{const o=e.match(i.viewItem);if(!o)return;const c=o.match;if(!r.consumable.test(i.viewItem,c))return;const d=r.writer.createText(" ",{restrictedEditingException:!0});r.safeInsert(d,i.modelCursor)&&(r.consumable.consume(i.viewItem,c),i.modelRange=r.writer.createRange(i.modelCursor,i.modelCursor.getShiftedBy(d.offsetSize)),i.modelCursor=i.modelRange.end)},{priority:"low"}))}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class K extends E{static get pluginName(){return"StandardEditingModeUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,n=e.ui.componentFactory;n.add("restrictedEditingException:dropdown",t=>{const i=A(t),r=t.t,o=[n.create("restrictedEditingException:inline"),n.create("restrictedEditingException:block")];for(const c of o)c.set({withText:!0,tooltip:!1});return te(i,o,{enableActiveItemFocusOnDropdownOpen:!0,isVertical:!0,ariaLabel:r("Enable editing")}),i.buttonView.set({label:r("Enable editing"),icon:P,tooltip:!0}),i.extendTemplate({attributes:{class:"ck-restricted-editing-dropdown"}}),i.bind("isEnabled").toMany(o,"isEnabled",(...c)=>c.some(d=>d)),this.listenTo(i,"execute",()=>{e.editing.view.focus()}),i}),n.add("restrictedEditingException:inline",()=>{const t=this._createButton("restrictedEditingException",I);return t.set({tooltip:!0,isToggleable:!0}),t}),n.add("restrictedEditingException:block",()=>{const t=this._createButton("restrictedEditingExceptionBlock",I);return t.set({tooltip:!0,isToggleable:!0}),t}),n.add("menuBar:restrictedEditingException:inline",()=>this._createButton("restrictedEditingException",b)),n.add("menuBar:restrictedEditingException:block",()=>this._createButton("restrictedEditingExceptionBlock",b)),n.add("restrictedEditingException",()=>n.create("restrictedEditingException:inline")),n.add("menuBar:restrictedEditingException",()=>n.create("menuBar:restrictedEditingException:inline"))}_createButton(e,n){const t=this.editor,i=t.locale,r=this.editor.commands.get(e),o=new n(i),c=i.t;return o.icon=P,o.bind("isOn","isEnabled").to(r,"value","isEnabled"),e=="restrictedEditingExceptionBlock"?o.bind("label").to(r,"value",d=>c(d?"Disable block editing":"Enable block editing")):o.bind("label").to(r,"value",d=>c(d?"Disable inline editing":"Enable inline editing")),this.listenTo(o,"execute",()=>{t.execute(e),t.editing.view.focus()}),o}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class me extends E{static get pluginName(){return"StandardEditingMode"}static get isOfficialPlugin(){return!0}static get requires(){return[G,K]}}export{L as RestrictedEditingExceptionBlockCommand,H as RestrictedEditingExceptionCommand,le as RestrictedEditingMode,W as RestrictedEditingModeEditing,w as RestrictedEditingModeNavigationCommand,$ as RestrictedEditingModeUI,me as StandardEditingMode,G as StandardEditingModeEditing,K as StandardEditingModeUI,O as _extendRestrictedEditingMarkerOnTypingPostFixer,u as _getRestrictedEditingMarkerAtPosition,k as _isRestrictedEditingPositionInRangeBoundaries,D as _isRestrictedEditingSelectionInMarker,V as _resurrectRestrictedEditingCollapsedMarkerPostFixer,N as _setupRestrictedEditingExceptionHighlighting,_ as _upcastRestrictedEditingHighlightToMarker};
