import{Plugin as k,Command as F}from"@ckeditor/ckeditor5-core";import{IconImportWord as N}from"@ckeditor/ckeditor5-icons";import{FileDialogButtonView as O,MenuBarMenuListItemFileDialogButtonView as R,SpinnerView as S,Notification as D}from"@ckeditor/ckeditor5-ui";import{ClipboardPipeline as T}from"@ckeditor/ckeditor5-clipboard";import{ModelRange as C}from"@ckeditor/ckeditor5-engine";import{first as y,uid as M,logWarning as V,logError as q}from"@ckeditor/ckeditor5-utils";function P(a,t){const x=a.t;switch(t){case"Import from Word":return x("Import from Word");case"An error occurred while importing the Word file.":return x("An error occurred while importing the Word file.");case"Importing Word document":return x("Importing Word document");default:return t}}function l(a,t){const x=h();return l=function(e,r){return e=e-417,x[e]},l(a,t)}function h(){const a=["Importing Word document","menuBar:importWord","1250955AltwMY","isPremiumPlugin","1839431IazRDn","set","58285hxkYWe","isEnabled","focus","get","add","79649baEOJx","318qVbhKA","bind","Import from Word","tooltip","iconView","isOn","111764ankhbr","_createButton","2065539cLcvLN","isBusy","view","init","application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.openxmlformats-officedocument.wordprocessingml.template","ImportWordUI","execute","label","importWord","2297488SyddJJ","locale","done","isOfficialPlugin","componentFactory","14uNaNAL","30pOfMdH","33jRSNuz","children","commands","isVisible","editing","editor","pluginName"];return h=function(){return a},h()}const b=l;(function(a,t){const x=l,e=a();for(;;)try{if(-parseInt(x(440))/1*(parseInt(x(420))/2)+parseInt(x(422))/3*(-parseInt(x(447))/4)+parseInt(x(435))/5*(parseInt(x(441))/6)+parseInt(x(449))/7+-parseInt(x(458))/8+parseInt(x(431))/9*(parseInt(x(421))/10)+parseInt(x(433))/11===t)break;e.push(e.shift())}catch{e.push(e.shift())}})(h,345024);class B extends k{static get[b(428)](){return b(454)}static get[b(418)](){return!0}static get[b(432)](){return!0}[b(452)](){const t=b,x=this[t(427)];x.ui[t(419)][t(439)](t(457),()=>{const e=t,r=this[e(448)](O),n=x[e(424)][e(438)](e(457));return r[e(442)](e(446)).to(n,e(450)),r[e(444)]=!0,r}),x.ui[t(419)][t(439)](t(430),()=>this[t(448)](R))}[b(448)](t){const x=b,e=this[x(427)],r=e[x(424)][x(438)](x(457)),n=new t(e[x(459)]),i=new S;return n[x(434)]({acceptedType:x(453)}),n[x(434)]({icon:N}),n[x(442)](x(436)).to(r),n[x(442)](x(456)).to(r,x(450),o=>P(e[x(459)],x(o?429:443))),i[x(442)](x(425)).to(r,x(450)),n[x(445)][x(442)](x(425)).to(r,x(450),o=>!o),n[x(423)][x(439)](i),n.on(x(417),(o,d)=>{const c=x;e[c(455)](c(457),d[0],{}),e[c(426)][c(451)][c(437)]()}),n}}function _(){const a=["importWord:","isEnabled","json","_handleImportFailure","isCollapsed","bind","enqueueChange","paragraph","getFirstPosition","createBatch","9706780PTmzFh","selection","set","isBusy","DateTimeFormat","_checkEnabled","isAtEnd","value","formatting","createPositionAfter","_abortController","parent","get","headers","schema","stopListening","change:range","resolve","_prepareForImport","showWarning","view","has","split","isAtStart","_undoStepBatch","setSelection","mergeFields","model","getSelectedBlocks","finally","root","execute","aborted","9EijVto","$graveyard","checkChild","import-word-plugin-import-cancelled","html","signal","1554000hjYDNV","document","getRange","clipboardInput","abort","_handleImportResponse","timeZone","createPositionBefore","MergeFields","editor","_sendImportRequest","Authorization","2085368eVGUqZ","editing","dataInsert","position","markers","525281amaIWX","then","plugins","rootName","text/html","deleteContent","_importMarker","7yvJoJr","addMarker","ImportWordEditing","low","resolvedOptions","locale","getToken","import-word-plugin-conversion-failed","setData","importWord","stringify","1085788icWlES","5056KWuxfo","catch","Notification","477prUZVR","merge_fields","removeMarker","An error occurred while importing the Word file.","isEmpty","file","reject","_cleanUpAfterImport","refresh","converterUrl","POST","fire","element","config","3129540hMUapG"];return _=function(){return a},_()}const s=m;function m(a,t){const x=_();return m=function(e,r){return e=e-410,x[e]},m(a,t)}(function(a,t){const x=m,e=a();for(;;)try{if(parseInt(x(501))/1+-parseInt(x(416))/2+-parseInt(x(420))/3*(parseInt(x(417))/4)+parseInt(x(484))/5+-parseInt(x(434))/6+parseInt(x(508))/7*(-parseInt(x(496))/8)+parseInt(x(478))/9*(parseInt(x(445))/10)===t)break;e.push(e.shift())}catch{e.push(e.shift())}})(_,280628);class E extends F{[s(507)];[s(469)];[s(455)];constructor(t){const x=s;super(t),this[x(447)](x(448),!1),this[x(507)]=null,this[x(469)]=null,this[x(455)]=null,this.on(x(498),(e,r)=>{const n=x,i=new DataTransfer;i[n(413)](n(505),r[n(482)]);const o=this[n(507)][n(486)]();this[n(493)][n(472)][n(441)](this[n(469)],d=>{const c=n;this[c(507)][c(460)](),d[c(470)](o),t[c(497)][c(465)][c(485)][c(431)](c(487),{dataTransfer:i})})},{priority:x(511)})}[s(428)](){const t=s;this[t(436)]=this[t(450)]()}[s(476)](t,x={}){const e=s;if(this[e(448)])return Promise[e(462)]();const r=this[e(493)][e(433)][e(457)](e(414));if(this[e(493)][e(503)][e(466)](e(492))){const{prefix:i,suffix:o}=this[e(493)][e(433)][e(457)](e(471));x[e(421)]={prefix:i,suffix:o}}const n={url:r[e(429)],file:t,serviceConfig:{...x,formatting:r[e(453)],timezone:new Intl[e(449)]()[e(512)]()[e(490)]}};return this[e(463)](),this[e(494)](n)[e(502)](this[e(489)][e(440)](this))[e(418)](this[e(438)][e(440)](this))[e(474)](this[e(427)][e(440)](this))}[s(450)](){const t=s;if(this[t(448)])return!1;const x=this[t(493)][t(472)],e=x[t(459)],r=x[t(485)][t(446)],n=y(r[t(473)]());return!!n&&e[t(480)](n[t(456)],t(442))}[s(463)](){const t=s,x=this[t(493)],e=x[t(472)],r=e[t(485)][t(446)];this[t(455)]=new AbortController,this[t(469)]=x[t(472)][t(444)]({isUndoable:!0}),e[t(441)](this[t(469)],n=>{const i=t;r[i(439)]||e[i(506)](r,{leaveUnmerged:!0});const o=r[i(443)](),d=y(r[i(473)]());let c;c=d.is(i(432),i(442))&&d[i(424)]?o:o[i(468)]?e[i(491)](d):o[i(451)]?e[i(454)](d):n[i(467)](o)[i(499)],this[i(507)]=n[i(509)](i(435)+M(),{usingOperation:!1,affectsData:!1,range:new C(c)}),this[i(507)].on(i(461),()=>{const u=i;u(479)===this[u(507)][u(486)]()[u(475)][u(504)]&&this[u(455)][u(488)]()})}),this[t(448)]=!0,this[t(428)]()}[s(427)](){const t=s,x=this[t(493)][t(472)];x[t(500)][t(466)](this[t(507)])&&x[t(441)](this[t(469)],e=>{const r=t;e[r(422)](this[r(507)])}),this[t(507)]=null,this[t(469)]=null,this[t(455)]=null,this[t(448)]=!1,this[t(428)]()}[s(494)]({url:t,file:x,serviceConfig:e}){const r=s,n=this[r(493)][r(503)][r(457)](r(510))[r(411)](),i=new FormData;i[r(447)](r(433),JSON[r(415)](e)),i[r(447)](r(425),x);const o={method:r(430),headers:{},body:i,signal:this[r(455)][r(483)]};return n&&(o[r(458)][r(495)]=n[r(452)]),fetch(t,o)}[s(489)](t){const x=s;return t.ok?t[x(437)]()[x(502)](e=>{const r=x;this[r(493)][r(472)][r(500)][r(466)](this[r(507)])&&r(479)!==this[r(507)][r(486)]()[r(475)][r(504)]&&this[r(431)](r(498),e)}):Promise[x(426)]()}[s(438)](){const t=s;if(this[t(455)][t(483)][t(477)])return void V(t(481));const x=this[t(493)],e=P(x[t(410)],t(423));x[t(503)][t(457)](t(419))[t(464)](e),q(t(412))}}const f=I;(function(a,t){const x=I,e=a();for(;;)try{if(-parseInt(x(183))/1*(parseInt(x(187))/2)+parseInt(x(196))/3*(parseInt(x(199))/4)+-parseInt(x(176))/5*(parseInt(x(190))/6)+-parseInt(x(186))/7*(parseInt(x(172))/8)+parseInt(x(191))/9+parseInt(x(168))/10+parseInt(x(170))/11===t)break;e.push(e.shift())}catch{e.push(e.shift())}})(g,340590);function I(a,t){const x=g();return I=function(e,r){return e=e-168,x[e]},I(a,t)}function g(){const a=["2375846oqGqZK","commands","443376VhAISX","CloudServices","add","isOfficialPlugin","15OsIjwD","none","editor","plugins","pluginName","getToken","define","242911ovOxaQ","requires","registerTokenUrl","14SiGcSW","2UwRKoP","token","tokenUrl","482358LpFZgk","712512frLNeT","https://docx-converter.cke-cs.com/v2/convert/docx-html","importWord","ImportWordEditing","get","51024UHXEMA","inline","config","32reBqKY","isPremiumPlugin","init","_token","5043060yKfWER","cloudServices"];return g=function(){return a},g()}class A extends k{[f(202)];static get[f(180)](){return f(194)}static get[f(175)](){return!0}static get[f(200)](){return!0}static get[f(184)](){return[D,T,f(173)]}constructor(t){const x=f;super(t),this[x(202)]=null}async[f(201)](){const t=f,x=this[t(178)];x[t(198)][t(182)](t(193),{converterUrl:t(192),tokenUrl:(x[t(198)][t(195)](t(169))||{})[t(189)],formatting:{resets:t(177),defaults:t(177),styles:t(197)}}),x[t(171)][t(174)](t(193),new E(x));const{tokenUrl:e}=x[t(198)][t(195)](t(193));if(e){const{tokenUrl:r}=x[t(198)][t(195)](t(169))||{};this[t(202)]=e===r?x[t(179)][t(195)](t(173))[t(188)]:await x[t(179)][t(195)](t(173))[t(185)](e)}}[f(181)](){return this[f(202)]}}function v(){var a=["20965QOkDZE","466xeypIg","isPremiumPlugin","8120783uVAULG","29356YrbBJY","requires","358470FoBuTB","1352klFRwz","36EjRrem","490745baFDes","261mRPYEH","ImportWord","13816392zIkFcU","3845UeGiBO","246fwGbsz","isOfficialPlugin","pluginName"];return v=function(){return a},v()}var p=w;(function(a,t){for(var x=w,e=a();;)try{var r=parseInt(x(273))/1*(parseInt(x(278))/2)+parseInt(x(274))/3*(-parseInt(x(281))/4)+parseInt(x(269))/5*(parseInt(x(268))/6)+-parseInt(x(277))/7*(-parseInt(x(267))/8)+parseInt(x(270))/9*(parseInt(x(266))/10)+-parseInt(x(280))/11+-parseInt(x(272))/12;if(r===t)break;e.push(e.shift())}catch{e.push(e.shift())}})(v,539080);function w(a,t){var x=v();return w=function(e,r){e=e-265;var n=x[e];return n},w(a,t)}class z extends k{static get[p(276)](){var t=p;return t(271)}static get[p(275)](){return!0}static get[p(279)](){return!0}static get[p(265)](){return[A,B]}}(function(a,t){for(var x=U,e=a();;)try{var r=parseInt(x(168))/1+parseInt(x(163))/2*(parseInt(x(164))/3)+parseInt(x(165))/4*(parseInt(x(169))/5)+parseInt(x(167))/6+parseInt(x(166))/7+-parseInt(x(162))/8+-parseInt(x(170))/9;if(r===t)break;e.push(e.shift())}catch{e.push(e.shift())}})(W,417405);function W(){var a=["4015GKhUiU","1583766wRflvN","6028320DBXAgR","4574zJTOxN","120ZLaYDy","268CTBRct","3022285mPtoUp","642270fZMkgw","662838WkglNM"];return W=function(){return a},W()}function U(a,t){var x=W();return U=function(e,r){e=e-162;var n=x[e];return n},U(a,t)}export{z as ImportWord,E as ImportWordCommand,A as ImportWordEditing,B as ImportWordUI};
