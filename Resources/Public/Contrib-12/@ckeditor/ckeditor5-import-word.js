import{Plugin as k,Command as B}from"@ckeditor/ckeditor5-core";import{IconImportWord as M}from"@ckeditor/ckeditor5-icons";import{FileDialogButtonView as U,MenuBarMenuListItemFileDialogButtonView as V,SpinnerView as A,Notification as E}from"@ckeditor/ckeditor5-ui";import{ClipboardPipeline as O}from"@ckeditor/ckeditor5-clipboard";import{ModelRange as j}from"@ckeditor/ckeditor5-engine";import{first as P,uid as K,logWarning as N,logError as T}from"@ckeditor/ckeditor5-utils";function F(a,t){const x=a.t;switch(t){case"Import from Word":return x("Import from Word");case"An error occurred while importing the Word file.":return x("An error occurred while importing the Word file.");case"Importing Word document":return x("Importing Word document");default:return t}}const u=l;function l(a,t){const x=h();return l=function(e,r){return e=e-163,x[e]},l(a,t)}(function(a,t){const x=l,e=a();for(;;)try{if(parseInt(x(189))/1*(parseInt(x(201))/2)+parseInt(x(180))/3+-parseInt(x(165))/4+parseInt(x(192))/5+-parseInt(x(172))/6+parseInt(x(185))/7+parseInt(x(191))/8*(-parseInt(x(182))/9)===t)break;e.push(e.shift())}catch{e.push(e.shift())}})(h,241697);function h(){const a=["children","8RVQVOG","isBusy","add","isEnabled","importWord","612304MeSIaS","ImportWordUI","view","editing","Importing Word document","bind","iconView","81402LzdZEM","isVisible","execute","pluginName","label","menuBar:importWord","_createButton","componentFactory","104700pvBaGV","isOn","6381FmpVMn","tooltip","focus","693126VYwuqV","application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.openxmlformats-officedocument.wordprocessingml.template","get","commands","38145WxLxjB","set","1752YxCikS","1385565YrWbDS","locale","isPremiumPlugin","done","Import from Word","isOfficialPlugin","editor","init"];return h=function(){return a},h()}class S extends k{static get[u(175)](){return u(166)}static get[u(197)](){return!0}static get[u(194)](){return!0}[u(199)](){const t=u,x=this[t(198)];x.ui[t(179)][t(203)](t(164),()=>{const e=t,r=this[e(178)](U),n=x[e(188)][e(187)](e(164));return r[e(170)](e(181)).to(n,e(202)),r[e(183)]=!0,r}),x.ui[t(179)][t(203)](t(177),()=>this[t(178)](V))}[u(178)](t){const x=u,e=this[x(198)],r=e[x(188)][x(187)](x(164)),n=new t(e[x(193)]),i=new A;return n[x(190)]({acceptedType:x(186)}),n[x(190)]({icon:M}),n[x(170)](x(163)).to(r),n[x(170)](x(176)).to(r,x(202),o=>F(e[x(193)],x(o?169:196))),i[x(170)](x(173)).to(r,x(202)),n[x(171)][x(170)](x(173)).to(r,x(202),o=>!o),n[x(200)][x(203)](i),n.on(x(195),(o,d)=>{const c=x;e[c(174)](c(164),d[0],{}),e[c(168)][c(167)][c(184)]()}),n}}function _(){const a=["resolvedOptions","isEmpty","parent","57756pKhesn","Notification","checkChild","fire","stopListening","_prepareForImport","model","html","import-word-plugin-conversion-failed","importWord:","isAtStart","schema","change:range","converterUrl","split","editing","has","An error occurred while importing the Word file.","paragraph","DateTimeFormat","_importMarker","merge_fields","createPositionAfter","23211BgCYJy","ImportWordEditing","getRange","_abortController","1557168wnaZft","_cleanUpAfterImport","timeZone","isAtEnd","$graveyard","isBusy","Authorization","value","getSelectedBlocks","getToken","_sendImportRequest","signal","isCollapsed","11113920fwFAsi","_handleImportResponse","file","importWord","2427887KhfVbc","aborted","clipboardInput","createBatch","plugins","text/html","4FwqOjO","config","root","execute","position","set","createPositionBefore","then","import-word-plugin-import-cancelled","rootName","deleteContent","2224LkBCoZ","bind","423pxFjGB","getFirstPosition","editor","isEnabled","stringify","dataInsert","mergeFields","finally","headers","element","low","POST","selection","markers","309540qyACuu","view","25vxWDQf","abort","document","_checkEnabled","catch","get","_handleImportFailure","_undoStepBatch","setSelection","enqueueChange","resolve","removeMarker","json","locale","refresh","addMarker","formatting","showWarning","MergeFields","reject","setData"];return _=function(){return a},_()}const s=m;(function(a,t){const x=m,e=a();for(;;)try{if(parseInt(x(534))/1*(parseInt(x(481))/2)+parseInt(x(454))/3+-parseInt(x(508))/4*(parseInt(x(510))/5)+-parseInt(x(458))/6+-parseInt(x(475))/7+-parseInt(x(492))/8*(-parseInt(x(494))/9)+parseInt(x(471))/10===t)break;e.push(e.shift())}catch{e.push(e.shift())}})(_,254413);function m(a,t){const x=_();return m=function(e,r){return e=e-434,x[e]},m(a,t)}class C extends B{[s(451)];[s(517)];[s(457)];constructor(t){const x=s;super(t),this[x(486)](x(463),!1),this[x(451)]=null,this[x(517)]=null,this[x(457)]=null,this.on(x(499),(e,r)=>{const n=x,i=new DataTransfer;i[n(530)](n(480),r[n(438)]);const o=this[n(451)][n(456)]();this[n(496)][n(437)][n(519)](this[n(517)],d=>{const c=n;this[c(451)][c(435)](),d[c(518)](o),t[c(446)][c(509)][c(512)][c(434)](c(477),{dataTransfer:i})})},{priority:x(504)})}[s(524)](){const t=s;this[t(497)]=this[t(513)]()}[s(484)](t,x={}){const e=s;if(this[e(463)])return Promise[e(520)]();const r=this[e(496)][e(482)][e(515)](e(474));if(this[e(496)][e(479)][e(447)](e(528))){const{prefix:i,suffix:o}=this[e(496)][e(482)][e(515)](e(500));x[e(452)]={prefix:i,suffix:o}}const n={url:r[e(444)],file:t,serviceConfig:{...x,formatting:r[e(526)],timezone:new Intl[e(450)]()[e(531)]()[e(460)]}};return this[e(436)](),this[e(468)](n)[e(488)](this[e(472)][e(493)](this))[e(514)](this[e(516)][e(493)](this))[e(501)](this[e(459)][e(493)](this))}[s(513)](){const t=s;if(this[t(463)])return!1;const x=this[t(496)][t(437)],e=x[t(442)],r=x[t(512)][t(506)],n=P(r[t(466)]());return!!n&&e[t(536)](n[t(533)],t(449))}[s(436)](){const t=s,x=this[t(496)],e=x[t(437)],r=e[t(512)][t(506)];this[t(457)]=new AbortController,this[t(517)]=x[t(437)][t(478)]({isUndoable:!0}),e[t(519)](this[t(517)],n=>{const i=t;r[i(470)]||e[i(491)](r,{leaveUnmerged:!0});const o=r[i(495)](),d=P(r[i(466)]());let c;c=d.is(i(503),i(449))&&d[i(532)]?o:o[i(441)]?e[i(487)](d):o[i(461)]?e[i(453)](d):n[i(445)](o)[i(485)],this[i(451)]=n[i(525)](i(440)+K(),{usingOperation:!1,affectsData:!1,range:new j(c)}),this[i(451)].on(i(443),()=>{const b=i;b(462)===this[b(451)][b(456)]()[b(483)][b(490)]&&this[b(457)][b(511)]()})}),this[t(463)]=!0,this[t(524)]()}[s(459)](){const t=s,x=this[t(496)][t(437)];x[t(507)][t(447)](this[t(451)])&&x[t(519)](this[t(517)],e=>{const r=t;e[r(521)](this[r(451)])}),this[t(451)]=null,this[t(517)]=null,this[t(457)]=null,this[t(463)]=!1,this[t(524)]()}[s(468)]({url:t,file:x,serviceConfig:e}){const r=s,n=this[r(496)][r(479)][r(515)](r(455))[r(467)](),i=new FormData;i[r(486)](r(482),JSON[r(498)](e)),i[r(486)](r(473),x);const o={method:r(505),headers:{},body:i,signal:this[r(457)][r(469)]};return n&&(o[r(502)][r(464)]=n[r(465)]),fetch(t,o)}[s(472)](t){const x=s;return t.ok?t[x(522)]()[x(488)](e=>{const r=x;this[r(496)][r(437)][r(507)][r(447)](this[r(451)])&&r(462)!==this[r(451)][r(456)]()[r(483)][r(490)]&&this[r(434)](r(499),e)}):Promise[x(529)]()}[s(516)](){const t=s;if(this[t(457)][t(469)][t(476)])return void N(t(489));const x=this[t(496)],e=F(x[t(523)],t(448));x[t(479)][t(515)](t(535))[t(527)](e),T(t(439))}}const f=I;(function(a,t){const x=I,e=a();for(;;)try{if(-parseInt(x(197))/1*(-parseInt(x(177))/2)+parseInt(x(172))/3+parseInt(x(189))/4+-parseInt(x(188))/5*(-parseInt(x(184))/6)+-parseInt(x(167))/7*(-parseInt(x(168))/8)+parseInt(x(186))/9+-parseInt(x(192))/10*(parseInt(x(183))/11)===t)break;e.push(e.shift())}catch{e.push(e.shift())}})(g,686699);function I(a,t){const x=g();return I=function(e,r){return e=e-166,x[e]},I(a,t)}class D extends k{[f(170)];static get[f(191)](){return f(176)}static get[f(193)](){return!0}static get[f(181)](){return!0}static get[f(198)](){return[E,O,f(187)]}constructor(t){const x=f;super(t),this[x(170)]=null}async[f(180)](){const t=f,x=this[t(173)];x[t(185)][t(182)](t(179),{converterUrl:t(171),tokenUrl:(x[t(185)][t(178)](t(166))||{})[t(195)],formatting:{resets:t(196),defaults:t(196),styles:t(190)}}),x[t(200)][t(194)](t(179),new C(x));const{tokenUrl:e}=x[t(185)][t(178)](t(179));if(e){const{tokenUrl:r}=x[t(185)][t(178)](t(166))||{};this[t(170)]=e===r?x[t(169)][t(178)](t(187))[t(199)]:await x[t(169)][t(178)](t(187))[t(175)](e)}}[f(174)](){return this[f(170)]}}function g(){const a=["272xPXXKU","plugins","_token","https://docx-converter.cke-cs.com/v2/convert/docx-html","2061144ASYDqm","editor","getToken","registerTokenUrl","ImportWordEditing","1318468cCWvDh","get","importWord","init","isPremiumPlugin","define","939026JkOcpw","6240378UnDlmF","config","8198586EsDiJC","CloudServices","5PaXVeP","3760480GmfWIo","inline","pluginName","630Rhosxl","isOfficialPlugin","add","tokenUrl","none","2kSUopv","requires","token","commands","cloudServices","240492dDRnai"];return g=function(){return a},g()}var p=W;function v(){var a=["ImportWord","15374270dvKKzD","1149198vWUDuk","pluginName","10216101eWdhgE","4351329mhVQZk","27nuWwIS","isOfficialPlugin","3942392jEAWyz","requires","6016624KsBNWI","5gMZjgz","4673igivuQ","isPremiumPlugin","222tYdXgl"];return v=function(){return a},v()}(function(a,t){for(var x=W,e=a();;)try{var r=-parseInt(x(411))/1*(parseInt(x(413))/2)+parseInt(x(419))/3+-parseInt(x(424))/4+parseInt(x(425))/5*(-parseInt(x(416))/6)+-parseInt(x(418))/7+-parseInt(x(422))/8*(-parseInt(x(420))/9)+parseInt(x(415))/10;if(r===t)break;e.push(e.shift())}catch{e.push(e.shift())}})(v,792432);function W(a,t){var x=v();return W=function(e,r){e=e-411;var n=x[e];return n},W(a,t)}class q extends k{static get[p(417)](){var t=p;return t(414)}static get[p(421)](){return!0}static get[p(412)](){return!0}static get[p(423)](){return[D,S]}}(function(a,t){for(var x=y,e=a();;)try{var r=parseInt(x(486))/1*(-parseInt(x(488))/2)+parseInt(x(484))/3+-parseInt(x(487))/4*(-parseInt(x(481))/5)+-parseInt(x(480))/6+-parseInt(x(477))/7*(-parseInt(x(478))/8)+-parseInt(x(479))/9*(parseInt(x(482))/10)+-parseInt(x(485))/11*(-parseInt(x(483))/12);if(r===t)break;e.push(e.shift())}catch{e.push(e.shift())}})(w,236811);function y(a,t){var x=w();return y=function(e,r){e=e-477;var n=x[e];return n},y(a,t)}function w(){var a=["127064KXjMFs","136oiVmJl","1683YdFVxI","749460MnGsin","10LLMXNe","3820RKcFSW","12csHOWn","466347JIjoMe","706750KDFukh","44021SMiljA","161912DSJdhL","8zYJdKx"];return w=function(){return a},w()}export{q as ImportWord,C as ImportWordCommand,D as ImportWordEditing,S as ImportWordUI};
